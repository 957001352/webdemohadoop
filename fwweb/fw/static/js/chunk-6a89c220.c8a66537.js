(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a89c220"],{"0a16":function(t,e,s){"use strict";var a=s("a372"),i=s.n(a);i.a},"215d":function(t,e,s){},3704:function(t,e,s){"use strict";var a=s("215d"),i=s.n(a);i.a},"3ee3":function(t,e,s){"use strict";var a=s("42cd"),i=s.n(a);i.a},"42cd":function(t,e,s){},62203:function(t,e,s){},6916:function(t,e,s){"use strict";var a=s("62203"),i=s.n(a);i.a},"97a2":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-container"},[s("el-page-header",{attrs:{content:"工艺模型"},on:{back:function(e){return t.backClick(null)}}}),s("div",{staticClass:"content1"},[t._m(0),s("div",{staticClass:"contentBody"},[s("el-form",{ref:"forms",attrs:{model:t.forms,rules:t.rules,"label-position":"left","label-width":"100px"}},[s("el-form-item",{attrs:{label:"工艺卡:",prop:"productName"}},[s("el-select",{staticClass:"inputCls",staticStyle:{"max-width":"300px"},attrs:{disabled:"add"!==t.type,placeholder:"工艺卡"},on:{change:function(e){return t.changeCraft()}},model:{value:t.forms.productName,callback:function(e){t.$set(t.forms,"productName",e)},expression:"forms.productName"}},t._l(t.listCard,(function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1)]),s("div",{staticClass:"content1",staticStyle:{overflow:"auto"}},[t._m(1),s("div",{staticClass:"contentBody",staticStyle:{"min-width":"1600px"}},[1===t.forms.productName||""===t.forms.productName?s("rj1",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e(),2===t.forms.productName?s("rj2",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e(),3===t.forms.productName?s("yb",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e(),4===t.forms.productName?s("gjj",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e(),5===t.forms.productName?s("ht",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e(),6===t.forms.productName?s("jjft",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e(),7===t.forms.productName?s("klsmf",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e(),8===t.forms.productName?s("dmg",{attrs:{type:t.type,"is-checked":t.isChecked}}):t._e()],1)]),"edit"===t.type?s("div",{staticClass:"content1"},[t._m(2),s("div",{staticClass:"contentBody",staticStyle:{overflow:"auto"}},[s("el-form",{ref:"upforms",attrs:{model:t.upforms,rules:t.rules,"label-position":"left","label-width":"100px"}},[s("el-form-item",{attrs:{label:"变更类型:",prop:"upType"}},[s("el-select",{staticClass:"inputCls",staticStyle:{"max-width":"300px"},attrs:{placeholder:"变更类型"},model:{value:t.upforms.upType,callback:function(e){t.$set(t.upforms,"upType",e)},expression:"upforms.upType"}},t._l(t.upList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1)],1),s("el-form-item",{attrs:{label:"变更原因:",prop:"upReason"}},[s("el-input",{staticStyle:{"max-width":"300px"},attrs:{placeholder:"变更原因",maxlength:"20"},model:{value:t.upforms.upReason,callback:function(e){t.$set(t.upforms,"upReason",e)},expression:"upforms.upReason"}})],1),s("el-form-item",{attrs:{label:"变更描述:",prop:"dis"}},[s("el-input",{staticStyle:{"max-width":"300px"},attrs:{rows:5,resize:"none",type:"textarea",placeholder:"变更描述",maxlength:"50"},model:{value:t.upforms.dis,callback:function(e){t.$set(t.upforms,"dis",e)},expression:"upforms.dis"}})],1)],1)],1)]):t._e(),"find"===t.type?s("div",{staticClass:"content1"},[t._m(3),s("div",{staticClass:"contentBody el-tablenew"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.logsList,"row-class-name":t.tableRowClassName,border:""}},[s("el-table-column",{attrs:{prop:"date",label:"序号",align:"center",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.$index+1)+" ")]}}],null,!1,3056706777)}),s("el-table-column",{attrs:{prop:"updateType",label:"变更类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(0===e.row.updateType?"临时变更":1===e.row.updateType?"永久变更":"")+" ")]}}],null,!1,2797812034)}),s("el-table-column",{attrs:{prop:"reason",label:"变更原因",align:"center","show-overflow-tooltip":"","min-width":"120px"}}),s("el-table-column",{attrs:{prop:"content",label:"变更内容描述",align:"center","show-overflow-tooltip":"","min-width":"120px"}}),s("el-table-column",{attrs:{prop:"user.name",label:"变更人员",align:"center"}}),s("el-table-column",{attrs:{prop:"createTime",label:"变更时间",align:"center",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.createTime&&e.row.createTime.length>10?e.row.createTime.substring(0,16):e.row.createTime)+" ")]}}],null,!1,1052956272)}),s("el-table-column",{attrs:{prop:"updateType",label:"审核结果",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.auditStatus)+" ")]}}],null,!1,3774294532)}),s("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{staticClass:"defaultTextBtn",attrs:{type:"text"},on:{click:function(s){return t.findInfo(e.row)}}},[s("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" 查看 ")],1)]}}],null,!1,94581656)})],1)],1)]):t._e(),s("div",{staticClass:"bottom"},["find"!==t.type?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm()}}},[t._v("保存")]):t._e()],1)],1)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 基本信息")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 工艺卡模板")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 变更操作")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 变更记录")])}],r=s("644f"),l=s("c0e9"),o=s.n(l),n=s("143e"),c=s("c547"),d=s("8de1"),p=s("69aa"),m=s("ff9a"),u=s("b3d9"),f=s("8c4a"),h=s("d1fc"),g={name:"NewCard",components:{rj1:n["a"],rj2:c["a"],yb:d["a"],gjj:p["a"],ht:m["a"],jjft:u["a"],klsmf:f["a"],dmg:h["a"]},props:{objstr:{type:Object,default:null}},data:function(){return{loading:!1,isChecked:!1,currentId:0,machineNameList:[],craftIdList:[],type:"",forms:{productName:""},upforms:{upType:"",upReason:"",dis:""},rules:{productName:[{required:!0,message:"请选择工艺卡",trigger:"blur"}],upType:[{required:!0,message:"请选择变更类型",trigger:"blur"}],upReason:[{required:!0,message:"请输入变更原因",trigger:"blur"}],dis:[{required:!0,message:"请输入变更描述",trigger:"blur"}]},upList:[{id:0,name:"临时变更"},{id:1,name:"永久变更"}],listCard:[],logsList:[],repairObj:null}},computed:{},watch:{},created:function(){},mounted:function(){var t=this;this.findListCards(),this.type=this.objstr.type,"add"!==this.type&&(this.loading=!0,Object(r["c"])({id:this.objstr.id}).then((function(e){t.loading=!1,t.forms.productName=e.data.cardId,sessionStorage.setItem("cardFromJson",e.data.craftData),"find"===t.type&&t.findCardLogs()})))},beforeDestroy:function(){},methods:{changeCraft:function(){sessionStorage.removeItem("cardFromJson")},tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===1?"table-row":""},findListCards:function(){var t=this;Object(r["i"])().then((function(e){t.listCard=e.data}))},findCardLogs:function(){var t=this;this.loading=!0,Object(r["e"])({paramsId:this.objstr.id}).then((function(e){t.logsList=e.data,t.loading=!1}))},findInfo:function(t){var e=this;this.loading=!0,this.forms.productName=0,Object(r["f"])({id:t.id}).then((function(t){console.log(t.data.craftAfterData),sessionStorage.setItem("cardFromJson",t.data.craftAfterData),e.forms.productName=t.data.cardId,e.loading=!1}))},submitForm:function(){var t=this,e="add"===this.type?"forms":"upforms";this.$refs[e].validate((function(e){e&&(t.isChecked=!0,t.loading=!0,setTimeout((function(){var e=sessionStorage.getItem("cardFromJson");if(console.log(e),t.isChecked=!1,!e)return t.$message({type:"error",message:"请输入设备编号！"}),void(t.loading=!1);var s=JSON.parse(e);if(!s.partCode)return t.$message({type:"error",message:"请输入零件编号！"}),void(t.loading=!1);if(!s.checked)return t.$message({type:"error",message:"输入参数不合法！"}),void(t.loading=!1);if(!s.partName)return t.$message({type:"error",message:"请输入零件名称！"}),void(t.loading=!1);if(!s.productId)return t.$message({type:"error",message:"请选择设备编号！"}),void(t.loading=!1);var a=document.getElementById("pdfreport"),i=t;o()(a,{imageTimeout:0,scale:1,dpi:96}).then((function(t){var a=t.toDataURL("image/jpeg",.5);if("add"===i.type){var l={cardId:i.forms.productName,partCode:s.partCode,partName:s.partName,productId:s.productId,craftData:e,mouldId:s.mouldNumber,picture:a,documentNo:s.documentNo};Object(r["l"])(l).then((function(t){i.loading=!1,0===t.code?(i.$message({message:"操作成功!",type:"success"}),i.backClick("1")):1e3===t.code&&i.$message({message:t.msg,type:"error"})}))}else{var o={content:i.upforms.dis,paramsId:i.objstr.id,reason:i.upforms.upReason,craftAfterData:e,updateType:i.upforms.upType};Object(r["m"])(o).then((function(t){i.loading=!1,0===t.code?(i.$message({message:"操作成功!",type:"success"}),i.backClick("1")):1e3===t.code&&i.$message({message:t.msg,type:"error"})}))}}))}),1e3))}))},backClick:function(t){this.$emit("DetailCallBack",{result:t})}}},v=g,b=(s("0a16"),s("2877")),y=Object(b["a"])(v,a,i,!1,null,"05e41eff",null);e["a"]=y.exports},a15b:function(t,e,s){"use strict";var a=s("23e7"),i=s("44ad"),r=s("fc6a"),l=s("a640"),o=[].join,n=i!=Object,c=l("join",",");a({target:"Array",proto:!0,forced:n||!c},{join:function(t){return o.call(r(this),void 0===t?",":t)}})},a372:function(t,e,s){},baa5:function(t,e,s){var a=s("23e7"),i=s("e58c");a({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},d9d6:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"searchInfo"},[s("span",{staticClass:"seachname"},[t._v(" 产品代码: ")]),s("el-input",{staticClass:"inputCls",attrs:{placeholder:"请输入产品代码",clearable:""},model:{value:t.searchKey.code,callback:function(e){t.$set(t.searchKey,"code",e)},expression:"searchKey.code"}}),s("span",{staticClass:"seachname",staticStyle:{"margin-left":"15px"}},[t._v(" 产品名称: ")]),s("el-input",{staticClass:"inputCls",attrs:{placeholder:"请输入产品名称",clearable:""},model:{value:t.searchKey.name,callback:function(e){t.$set(t.searchKey,"name",e)},expression:"searchKey.name"}}),s("el-button",{staticClass:"primaryBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"primary"},on:{click:t.searchBtn}},[s("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" 查询 ")],1),s("el-button",{staticClass:"resetBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"default",icon:"el-icon-refresh-right"},on:{click:t.searchrestBtn}},[t._v(" 重置 ")])],1),s("div",{staticClass:"searchInfo"},[t.hasPermission("processManage/add")?s("el-button",{staticClass:"addBtn",attrs:{type:"default",icon:"el-icon-plus"},on:{click:t.addBtn}},[t._v(" 新增")]):t._e(),t.hasPermission("processManage/delete")?s("el-button",{staticClass:"deleteBtn",attrs:{type:"default"},on:{click:function(e){return t.deleteAll()}}},[s("svg-icon",{attrs:{"icon-class":"delete"}}),t._v(" 批量删除 ")],1):t._e()],1),s("div",{staticClass:"el-tablenew"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,"row-class-name":t.tableRowClassName,border:"",height:"calc(100vh - 337px)"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),s("el-table-column",{attrs:{prop:"date",label:"序号",align:"center",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.$index+1)+" ")]}}])}),s("el-table-column",{attrs:{prop:"productCode",label:"产品代码",align:"center"}}),s("el-table-column",{attrs:{prop:"productName",label:"产品名称",align:"center"}}),s("el-table-column",{attrs:{prop:"beat",label:"周期",align:"center",width:"90px"}}),s("el-table-column",{attrs:{prop:"productType",label:"生产类型",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(0===e.row.productType?"全自动":1===e.row.productType?"半自动":"手动"))])]}}])}),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.createTime&&e.row.createTime.length>10?e.row.createTime.substring(0,10):e.row.createTime))])]}}])}),s("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.hasPermission("processManage/edit")?s("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(s){return t.editBtn(e.row)}}},[s("svg-icon",{attrs:{"icon-class":"edit"}}),t._v(" 编辑 ")],1):t._e(),t.hasPermission("processManage/delete")?s("el-button",{staticClass:"deleteTextBtn",attrs:{type:"text"},on:{click:function(s){return t.deleteBtn(e.row)}}},[s("svg-icon",{attrs:{"icon-class":"delete"}}),t._v(" 删除 ")],1):t._e()]}}])})],1),s("pagination",{staticClass:"pagePadd",attrs:{total:t.total,page:t.pageIndex,limit:t.pageSize},on:{"update:page":function(e){t.pageIndex=e},"update:limit":function(e){t.pageSize=e},pagination:t.handleCurrentChange}})],1),t.showDialog?s("div",{staticClass:"showDialogsty"},[s("operate-mould",{attrs:{objstr:t.objstr},on:{DetailCallBack:t.DetailCallBack}})],1):t._e()])},i=[],r=(s("a15b"),s("b0c0"),s("b85c")),l=s("644f"),o=s("333d"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("el-page-header",{attrs:{content:"工艺模型"},on:{back:function(e){return t.backClick(null)}}}),s("div",{staticClass:"content1"},[t._m(0),s("div",{staticClass:"contentBody"},[s("el-form",{ref:"forms",attrs:{model:t.forms,rules:t.rules,"label-position":"left","label-width":"100px"}},[s("el-row",[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"产品代码:",prop:"productCode"}},[s("el-select",{staticStyle:{"max-width":"300px",width:"100%"},attrs:{placeholder:"产品代码",filterable:""},on:{change:function(e){return t.handleMateriel()}},model:{value:t.forms.productCode,callback:function(e){t.$set(t.forms,"productCode",e)},expression:"forms.productCode"}},t._l(t.materielList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.code,value:t.code}})})),1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"产品名称:",prop:"productName"}},[s("el-input",{staticStyle:{"max-width":"300px"},attrs:{disabled:!0,placeholder:"产品名称",maxlength:"20"},model:{value:t.forms.productName,callback:function(e){t.$set(t.forms,"productName",e)},expression:"forms.productName"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"周期:",prop:"week"}},[s("el-input",{staticStyle:{"max-width":"300px"},attrs:{disabled:"find"===t.type,placeholder:"周期",maxlength:"20"},on:{input:function(e){t.forms.week=t.forms.week.replace(/[^0-9]/g,"")}},model:{value:t.forms.week,callback:function(e){t.$set(t.forms,"week",e)},expression:"forms.week"}})],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"模具:",prop:"moulds"}},[s("el-select",{staticStyle:{"max-width":"300px",width:"100%"},attrs:{placeholder:"模具",filterable:""},model:{value:t.forms.moulds,callback:function(e){t.$set(t.forms,"moulds",e)},expression:"forms.moulds"}},t._l(t.resumeList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.code,value:t.id}})})),1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"生产类型:",prop:"productType"}},[s("el-select",{staticStyle:{"max-width":"300px",width:"100%"},attrs:{placeholder:"生产类型",filterable:""},model:{value:t.forms.productType,callback:function(e){t.$set(t.forms,"productType",e)},expression:"forms.productType"}},t._l(t.typeList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1)],1)],1),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"零件照片:",prop:"picture"}},["find"!==t.type?s("el-upload",{attrs:{action:"",limit:1,"file-list":t.picList,"before-upload":t.beforeFile,"http-request":t.uploadImages,"list-type":"picture-card"},scopedSlots:t._u([{key:"file",fn:function(e){var a=e.file;return s("div",{},[s("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t.uploadImg+a.webPath,alt:""}}),s("span",{staticClass:"el-upload-list__item-actions"},[s("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(a)}}},[s("i",{staticClass:"el-icon-zoom-in"})]),s("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemoves(a)}}},[s("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,3906420530)},[s("i",{staticClass:"el-icon-plus"}),s("el-input",{staticStyle:{"margin-left":"33px",display:"none"},model:{value:t.forms.picture,callback:function(e){t.$set(t.forms,"picture",e)},expression:"forms.picture"}})],1):t._e(),"find"===t.type?s("el-image",{staticStyle:{width:"100px",height:"100px","margin-right":"15px",cursor:"pointer"},attrs:{src:t.uploadImg+t.forms.picture},on:{click:function(e){return t.handlePictureCardPreviews(t.uploadImg+t.forms.picture)}}}):t._e()],1)],1)],1)],1)],1)]),s("div",{staticClass:"content1"},[t._m(1),s("div",{staticClass:"contentBody",staticStyle:{overflow:"auto"}},[t.opeshow?s("process-flow"):t._e()],1)]),s("div",{staticClass:"content1"},[t._m(2),s("div",{staticClass:"contentBody",staticStyle:{overflow:"auto"}},[s("div",{staticClass:"bplist",staticStyle:{"margin-left":"33px"}},t._l(t.mouldsList,(function(e,a){return s("div",{key:a},[s("span",{staticClass:"seachname"},[t._v(" 设备名称: ")]),s("el-select",{staticClass:"inputCls",staticStyle:{"margin-right":"15px"},attrs:{placeholder:"请选择设备名称",filterable:"",clearable:""},on:{change:function(e){return t.getGoyiList(a)}},model:{value:e.machineName,callback:function(s){t.$set(e,"machineName",s)},expression:"item.machineName"}},t._l(t.machineNameList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1),s("span",{staticClass:"seachname"},[t._v(" 工艺卡绑定: ")]),s("el-select",{staticClass:"inputCls",staticStyle:{"margin-right":"15px"},attrs:{placeholder:"请选择工艺卡",filterable:""},model:{value:e.craftId,callback:function(s){t.$set(e,"craftId",s)},expression:"item.craftId"}},t._l(e.craftList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.partName,value:t.id}})})),1),s("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(s){return t.showCraft(e)}}},[s("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" 工艺卡详情 ")],1)],1)})),0)])]),s("div",{staticClass:"content1"},[t._m(3),s("div",{staticClass:"contentBody",staticStyle:{overflow:"auto"}},[s("el-tabs",{staticClass:"el-tablenew",model:{value:t.actives,callback:function(e){t.actives=e},expression:"actives"}},[s("el-tab-pane",{attrs:{label:"作业指导书",name:"1"}},[s("div",{staticClass:"bplist",staticStyle:{"margin-left":"33px"}},[s("el-upload",{staticClass:"styeFile",staticStyle:{"max-width":"500px"},attrs:{action:"","on-remove":t.handleRemove,"file-list":t.fileList,"http-request":t.uploadImage}},[s("el-button",{staticClass:"primaryBtn",attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)]),s("el-tab-pane",{attrs:{label:"检验规范",name:"2"}},[s("div",{staticClass:"bplist",staticStyle:{"margin-left":"33px"}},[s("el-upload",{staticClass:"styeFile",staticStyle:{"max-width":"500px"},attrs:{action:"","on-remove":t.handleRemove,"file-list":t.fileList1,"http-request":t.uploadImage}},[s("el-button",{staticClass:"primaryBtn",attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)]),s("el-tab-pane",{attrs:{label:"不合格封样指导书",name:"3"}},[s("div",{staticClass:"bplist",staticStyle:{"margin-left":"33px"}},[s("el-upload",{staticClass:"styeFile",staticStyle:{"max-width":"500px"},attrs:{action:"","on-remove":t.handleRemove,"file-list":t.fileList2,"http-request":t.uploadImage}},[s("el-button",{staticClass:"primaryBtn",attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)])],1)],1)]),s("div",{staticClass:"bottom"},["find"!==t.type?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("forms")}}},[t._v("保存")]):t._e()],1),t.showDialog?s("div",{staticClass:"showDialogsty"},[s("new-card",{attrs:{objstr:t.objstrs},on:{DetailCallBack:t.DetailCallBack}})],1):t._e(),s("el-dialog",{staticClass:"diags",attrs:{visible:t.dialogImgVisible,"append-to-body":""},on:{"update:visible":function(e){t.dialogImgVisible=e}}},[s("img",{staticStyle:{"max-width":"700px"},attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},c=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 基本信息")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 工艺模型")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 设备选择")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title"},[s("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 相关附件")])}],d=(s("c740"),s("baa5"),s("a434"),s("b64b"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"processsty"},[s("div",{staticClass:"startsty"},[t._v(" 指令下发 ")]),s("div",{staticClass:"start-bar"}),t._m(0),t._m(1),s("div",{staticClass:"firststy"},[t._v(" 物料线 ")]),s("div",{staticClass:"secoundsty"},[t._v(" 设备线 ")]),s("div",{staticClass:"thirdssty"},[t._v(" 模具线 ")]),t._m(2),t._m(3),t._m(4),s("div",{staticClass:"firststy-params",staticStyle:{left:"368px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("库房备料")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.materialPrepare,callback:function(e){t.$set(t.flows,"materialPrepare",e)},expression:"flows.materialPrepare"}}),t._v(" min ")],1),t._m(5),s("div",{staticClass:"firststy-params",staticStyle:{left:"548px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("领料")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.pickingTime,callback:function(e){t.$set(t.flows,"pickingTime",e)},expression:"flows.pickingTime"}}),t._v(" min ")],1),t._m(6),s("div",{staticClass:"firststy-params",staticStyle:{left:"728px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("拌料")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.mixingTime,callback:function(e){t.$set(t.flows,"mixingTime",e)},expression:"flows.mixingTime"}}),t._v(" min ")],1),t._m(7),s("div",{staticClass:"firststy-params",staticStyle:{left:"908px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("投料")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.feedTime,callback:function(e){t.$set(t.flows,"feedTime",e)},expression:"flows.feedTime"}}),t._v(" min ")],1),t._m(8),s("div",{staticClass:"firststy-params",staticStyle:{left:"1088px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("烘料")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.dryTime,callback:function(e){t.$set(t.flows,"dryTime",e)},expression:"flows.dryTime"}}),t._v(" min ")],1),t._m(9),s("div",{staticClass:"firststy-params",staticStyle:{left:"1268px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("含水率检测")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.waterMonitor,callback:function(e){t.$set(t.flows,"waterMonitor",e)},expression:"flows.waterMonitor"}}),t._v(" min ")],1),t._m(10),t._m(11),t._m(12),s("div",{staticClass:"secoundsty",staticStyle:{left:"1088px"}},[t._v(" 开机通知 ")]),t._m(13),s("div",{staticClass:"secoundsty-params",staticStyle:{left:"1268px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("升温")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.heatUp,callback:function(e){t.$set(t.flows,"heatUp",e)},expression:"flows.heatUp"}}),t._v(" min ")],1),s("div",{staticClass:"thirdssty-params",staticStyle:{left:"368px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("出库")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.modelOut,callback:function(e){t.$set(t.flows,"modelOut",e)},expression:"flows.modelOut"}}),t._v(" min ")],1),t._m(14),s("div",{staticClass:"thirdssty-params",staticStyle:{left:"548px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("产前保养")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.prenatalCare,callback:function(e){t.$set(t.flows,"prenatalCare",e)},expression:"flows.prenatalCare"}}),t._v(" min ")],1),t._m(15),s("div",{staticClass:"thirdssty-params",staticStyle:{left:"728px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("调运至待使用区")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.modelDebug,callback:function(e){t.$set(t.flows,"modelDebug",e)},expression:"flows.modelDebug"}}),t._v(" min ")],1),t._m(16),s("div",{staticClass:"thirdssty-params",staticStyle:{left:"908px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("上模")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.modelUp,callback:function(e){t.$set(t.flows,"modelUp",e)},expression:"flows.modelUp"}}),t._v(" min ")],1),t._m(17),s("div",{staticClass:"secoundsty-params",staticStyle:{left:"1448px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("首件调试")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.firstDebug,callback:function(e){t.$set(t.flows,"firstDebug",e)},expression:"flows.firstDebug"}}),t._v(" min ")],1),t._m(18),t._m(19),t._m(20),s("div",{staticClass:"secoundsty-params",staticStyle:{left:"1628px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("首件检验")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.firstCheck,callback:function(e){t.$set(t.flows,"firstCheck",e)},expression:"flows.firstCheck"}}),t._v(" min ")],1),t._m(21),s("div",{staticClass:"secoundsty",staticStyle:{left:"1808px"}},[t._v(" 生产时间 ")]),t._m(22),s("div",{staticClass:"secoundsty-params",staticStyle:{left:"1988px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("库房备料")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.productPrepare,callback:function(e){t.$set(t.flows,"productPrepare",e)},expression:"flows.productPrepare"}}),t._v(" min ")],1),s("div",{staticClass:"start-bar-width",staticStyle:{left:"2108px"}}),t._m(23),s("div",{staticClass:"firststy",staticStyle:{left:"2202px",top:"60px"}},[t._v(" 现场5S ")]),s("div",{staticClass:"firststy-params",staticStyle:{left:"2202px",top:"181px","padding-top":"5px"}},[s("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("下模")]),s("el-input-number",{staticStyle:{width:"60%"},attrs:{disabled:"find"===t.flows.type,precision:0,min:0,controls:!1,size:"mini",placeholder:""},on:{change:function(e){return t.setObj()}},model:{value:t.flows.modelDown,callback:function(e){t.$set(t.flows,"modelDown",e)},expression:"flows.modelDown"}}),t._v(" min ")],1),s("div",{staticClass:"end-box",staticStyle:{left:"2322px",top:"26px"}}),t._m(24),s("div",{staticClass:"startsty",staticStyle:{left:"2417px"}},[t._v(" 指令下发 ")])])}),p=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-box"},[s("div",{staticClass:"top-triangle"}),s("div",{staticClass:"bottom-triangle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-box1"},[s("div",{staticClass:"bottom-triangle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"307px",top:"25px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"307px",width:"594px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"594px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"307px",top:"255px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"488px",top:"25px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"668px",top:"25px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"848px",top:"25px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"1028px",top:"25px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"1208px",top:"25px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"line-bar"},[s("div",{staticClass:"up-triangle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"secoundsty-params",staticStyle:{left:"908px",width:"120px","padding-top":"18px"}},[t._v(" 具备上模"),s("br"),t._v(" 上料条件 ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"line-bar",staticStyle:{top:"181px",height:"35px"}},[s("div",{staticClass:"down-triangle",staticStyle:{top:"35px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"1208px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"488px",top:"255px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"668px",top:"255px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"848px",top:"255px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"1388px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"line-bottom-box",staticStyle:{left:"1388px"}},[s("div",{staticClass:"down-triangle",staticStyle:{top:"77px",left:"112px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"line-top-box",staticStyle:{left:"1028px"}},[s("div",{staticClass:"up-triangle",staticStyle:{left:"473px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"1568px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"1748px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"1928px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-box",staticStyle:{left:"2160px",top:"26px"}},[s("div",{staticClass:"top-triangle"}),s("div",{staticClass:"bottom-triangle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"start-bar-width",staticStyle:{left:"2357px"}},[s("div",{staticClass:"top-triangle",staticStyle:{top:"-5px",left:"53px"}})])}],m={data:function(){return{flows:{id:0,type:"",materialPrepare:0,pickingTime:0,mixingTime:0,feedTime:0,dryTime:0,waterMonitor:0,heatUp:0,firstDebug:0,firstCheck:0,productPrepare:0,modelOut:0,prenatalCare:0,modelDebug:0,modelUp:0,modelDown:0}}},mounted:function(){var t=sessionStorage.getItem("flowJson");if(t){var e=JSON.parse(t);this.flows={id:e.id,type:e.type,materialPrepare:e.materialPrepare,pickingTime:e.pickingTime,mixingTime:e.mixingTime,feedTime:e.feedTime,dryTime:e.dryTime,waterMonitor:e.waterMonitor,heatUp:e.heatUp,firstDebug:e.firstDebug,firstCheck:e.firstCheck,productPrepare:e.productPrepare,modelOut:e.modelOut,prenatalCare:e.prenatalCare,modelDebug:e.modelDebug,modelUp:e.modelUp,modelDown:e.modelDown}}},methods:{setObj:function(){sessionStorage.setItem("flowJson",JSON.stringify(this.flows))}}},u=m,f=(s("3704"),s("2877")),h=Object(f["a"])(u,d,p,!1,null,"fe50dfce",null),g=h.exports,v=s("20cc"),b=s("2ac3"),y=s("6ace"),x=s("97a2"),C={name:"OperateMould",components:{"process-flow":g,"new-card":x["a"]},props:{objstr:{type:Object,default:null}},data:function(){return{showDialog:!1,currentId:0,actives:"1",machineNameList:[],resumeList:[],picList:[],uploadImg:window.configs.api,dialogImageUrl:"",typeList:[{id:0,name:"全自动"},{id:1,name:"半自动"},{id:2,name:"手动"}],dialogImgVisible:!1,craftIdList:[],objstrs:null,type:"",forms:{productCode:"",productName:"",week:"",moulds:"",productType:"",picture:""},fileList:[],fileList1:[],fileList2:[],rules:{productCode:[{required:!0,message:"请输入产品名称",trigger:"blur"}],productName:[{required:!0,message:"请输入产品代码",trigger:"blur"}],week:[{required:!0,message:"请输入周期",trigger:"blur"}],moulds:[{required:!0,message:"请输入模具",trigger:"blur"}],productType:[{required:!0,message:"请选择生产类型",trigger:"blur"}],picture:[{required:!0,message:"请上传零件照片",trigger:"blur"}]},opeshow:!1,mouldsList:[{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]}],materielList:[],repairObj:null}},computed:{},watch:{},created:function(){},mounted:function(){var t=this;if(this.getAllCodeRequest(),this.resumeMouldLists(),this.type=this.objstr.type,"add"!==this.type){this.forms={productCode:this.objstr.productCode,productName:this.objstr.productName,week:this.objstr.beat?this.objstr.beat:"",moulds:this.objstr.mouldId?this.objstr.mouldId:"",picture:this.objstr.photo,productType:this.objstr.productType},this.picList=[{webPath:this.objstr.photo}];for(var e=0;e<this.objstr.caftModelProcesscList.length;e++)this.mouldsList[e].machineName=this.objstr.caftModelProcesscList[e].devicesId+"",this.mouldsList[e].craftId=this.objstr.caftModelProcesscList[e].cardId,this.getGoyiListInfo(e);this.fileList=this.objstr.fileList,this.fileList1=this.objstr.inspectionSpecList,this.fileList2=this.objstr.noneSampleList,sessionStorage.setItem("flowJson",JSON.stringify({id:this.objstr.id,type:this.type,materialPrepare:this.objstr.materialPrepare,pickingTime:this.objstr.pickingTime,mixingTime:this.objstr.mixingTime,feedTime:this.objstr.feedTime,dryTime:this.objstr.dryTime,waterMonitor:this.objstr.waterMonitor,heatUp:this.objstr.heatUp,firstDebug:this.objstr.firstDebug,firstCheck:this.objstr.firstCheck,productPrepare:this.objstr.productPrepare,modelOut:this.objstr.modelOut,prenatalCare:this.objstr.prenatalCare,modelDebug:this.objstr.modelDebug,modelUp:this.objstr.modelUp,modelDown:this.objstr.modelDown})),setTimeout((function(){t.handleMateriels()}),1e3)}else sessionStorage.setItem("flowJson",JSON.stringify({id:0,type:this.type,materialPrepare:0,pickingTime:0,mixingTime:0,feedTime:0,dryTime:0,waterMonitor:0,heatUp:0,firstDebug:0,firstCheck:0,productPrepare:0,modelOut:0,prenatalCare:0,modelDebug:0,modelUp:0,modelDown:0}));this.opeshow=!0},beforeDestroy:function(){},methods:{handleMateriel:function(){this.mouldsList=[{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]},{machineName:"",craftId:"",craftList:[]}],this.handleMateriels()},handleMateriels:function(){var t=this,e=this.materielList.findIndex((function(e){return t.forms.productCode===e.code}));e>-1&&(this.forms.productName=this.materielList[e].name,Object(l["g"])({partCode:this.forms.productCode}).then((function(e){0===e.code&&(t.machineNameList=e.data?e.data:[])})))},resumeMouldLists:function(){var t=this;Object(v["e"])({pageNum:1,pageSize:99999}).then((function(e){0===e.code&&(t.resumeList=e.data.list)}))},getAllCodeRequest:function(){var t=this;Object(b["b"])().then((function(e){0===e.code&&e.data.length>0&&(t.materielList=e.data)}))},findDevicesLists:function(){var t=this;Object(y["a"])({}).then((function(e){t.machineNameList=e.data?e.data:[]}))},addBP:function(){this.mouldsList.push({machineName:"",craftId:""})},deleteBP:function(t){this.mouldsList.splice(t,1)},uploadImages:function(t){var e=this,s=new FormData;s.append("file",t.file),s.append("isAdd",!0),Object(y["c"])(s).then((function(t){0===t.code&&(e.$message({type:"success",message:"上传成功！"}),e.picList=[t.data],e.forms.picture=t.data.webPath,setTimeout((function(){e.$refs.forms.validateField("picture")}),500))}))},handleRemoves:function(t){this.forms.picture="",this.picList=[]},handlePictureCardPreview:function(t){this.dialogImageUrl=this.uploadImg+t.webPath,this.dialogImgVisible=!0},handlePictureCardPreviews:function(t){this.dialogImageUrl=t,this.dialogImgVisible=!0},beforeFile:function(t){var e=t.name,s=e.substring(e.lastIndexOf(".")+1).toLowerCase();if("png"!==s&&"jpg"!==s&&"jpeg"!==s)return this.$message({type:"warning",message:"请上传png/jpg/jpeg格式图片！"}),!1;var a=t.size/1024/1024<200;return a?this.fileList.length>1?(this.$message.error("上传图片个数不能超过1个!"),!1):void 0:(this.$message.error("上传图片大小不能超过 200MB!"),!1)},getGoyiListInfo:function(t){var e=this,s={pageNum:1,pageSize:99999,productId:this.mouldsList[t].machineName};Object(l["d"])(s).then((function(s){if(e.mouldsList[t].craftList=s.data.list,s.data.list.length>0){var a,i=Object(r["a"])(s.data.list);try{for(i.s();!(a=i.n()).done;){var l=a.value;if(e.forms.productCode===l.partCode){e.mouldsList[t].craftId=l.id;break}}}catch(o){i.e(o)}finally{i.f()}}}))},getGoyiList:function(t){this.mouldsList[t].craftId="",null!==this.mouldsList[t].machineName&&""!==this.mouldsList[t].machineName&&this.getGoyiListInfo(t)},showCraft:function(t){sessionStorage.removeItem("cardFromJson");var e,s=Object(r["a"])(t.craftList);try{for(s.s();!(e=s.n()).done;){var a=e.value;if(t.craftId===a.id){this.objstrs=a,this.objstrs.type="find",sessionStorage.setItem("cardFromJson",JSON.stringify({productCode:a.partCode,productName:a.partName,craftNo:a.documentNo,deviceNo:a.productId}));break}}}catch(i){s.e(i)}finally{s.f()}this.showDialog=!0},handleRemove:function(t,e){console.log(t,e),"1"===this.actives?this.fileList=e:"2"===this.actives?this.fileList1=e:"3"===this.actives&&(this.fileList2=e)},uploadImage:function(t){var e=this,s=new FormData;s.append("file",t.file),s.append("isAdd",!0),Object(y["c"])(s).then((function(t){0===t.code&&("1"===e.actives?e.fileList=[t.data]:"2"===e.actives?e.fileList1=[t.data]:"3"===e.actives&&(e.fileList2=[t.data],console.log(e.fileList3)),e.$message({type:"success",message:"上传成功！"}))}))},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(t){var s=sessionStorage.getItem("flowJson");if(s){var a=JSON.parse(s);if(!a.materialPrepare&&0!==a.materialPrepare)return void e.$message({type:"error",message:"库房备料不能为空！"});if(!a.pickingTime&&0!==a.pickingTime)return void e.$message({type:"error",message:"领料不能为空！"});if(!a.mixingTime&&0!==a.mixingTime)return void e.$message({type:"error",message:"拌料不能为空！"});if(!a.feedTime&&0!==a.feedTime)return void e.$message({type:"error",message:"投料不能为空！"});if(!a.dryTime&&0!==a.dryTime)return void e.$message({type:"error",message:"烘料不能为空！"});if(!a.waterMonitor&&0!==a.waterMonitor)return void e.$message({type:"error",message:"含水量监测不能为空！"});if(!a.heatUp&&0!==a.heatUp)return void e.$message({type:"error",message:"升温不能为空！"});if(!a.firstDebug&&0!==a.firstDebug)return void e.$message({type:"error",message:"首件调试不能为空！"});if(!a.firstCheck&&0!==a.firstCheck)return void e.$message({type:"error",message:"首件检验不能为空！"});if(!a.productPrepare&&0!==a.productPrepare)return void e.$message({type:"error",message:"生产库房备料不能为空！"});if(!a.modelOut&&0!==a.modelOut)return void e.$message({type:"error",message:"出库不能为空！"});if(!a.prenatalCare&&0!==a.prenatalCare)return void e.$message({type:"error",message:"产前保养不能为空！"});if(!a.modelDebug&&0!==a.modelDebug)return void e.$message({type:"error",message:"调运至待使用区不能为空！"});if(!a.modelUp&&0!==a.modelUp)return void e.$message({type:"error",message:"上模不能为空！"});if(!a.modelDown&&0!==a.modelDown)return void e.$message({type:"error",message:"下模不能为空！"});var i,o=[],n=Object(r["a"])(e.fileList);try{for(n.s();!(i=n.n()).done;){var c=i.value;o.push(c.dataId)}}catch(_){n.e(_)}finally{n.f()}var d,p=[],m=Object(r["a"])(e.fileList1);try{for(m.s();!(d=m.n()).done;){var u=d.value;p.push(u.dataId)}}catch(_){m.e(_)}finally{m.f()}var f,h=[],g=Object(r["a"])(e.fileList2);try{for(g.s();!(f=g.n()).done;){var v=f.value;h.push(v.dataId)}}catch(_){g.e(_)}finally{g.f()}for(var b=[],y={},x=0;x<e.mouldsList.length;x++)e.mouldsList[x].craftId&&e.mouldsList[x].machineName&&(y[e.mouldsList[x].machineName]="",b.push({cardId:e.mouldsList[x].craftId,devicesId:e.mouldsList[x].machineName,craftModelId:"add"===e.type?void 0:e.objstr.id,priority:x}));var C=Object.keys(y);if(0===b.length)return void e.$message({type:"error",message:"至少选择一个设备！"});if(C.length!==b.length)return void e.$message({type:"error",message:"设备重复！"});var w={id:"add"===e.type?void 0:e.objstr.id,dryTime:a.dryTime,beat:e.forms.week,productType:e.forms.productType,photo:e.forms.picture,mouldId:e.forms.moulds,feedTime:a.feedTime,firstCheck:a.firstCheck,firstDebug:a.firstDebug,heatUp:a.heatUp,materialPrepare:a.materialPrepare,mixingTime:a.mixingTime,modelDebug:a.modelDebug,modelDown:a.modelDown,modelOut:a.modelOut,modelUp:a.modelUp,pickingTime:a.pickingTime,prenatalCare:a.prenatalCare,productPrepare:a.productPrepare,waterMonitor:a.waterMonitor,productCode:e.forms.productCode,productName:e.forms.productName,fileIds:o.join(","),inspectionSpecIds:p.join(","),noneSampleIds:h.join(","),caftModelProcesscList:b};Object(l["n"])(w).then((function(t){0===t.code?(e.$message({message:"操作成功!",type:"success"}),e.backClick("1")):1e3===t.code&&e.$message({message:t.msg,type:"error"})}))}}}))},DetailCallBack:function(t){this.showDialog=!1},backClick:function(t){this.$emit("DetailCallBack",{result:t})}}},w=C,_=(s("6916"),Object(f["a"])(w,n,c,!1,null,"a5956532",null)),S=_.exports,k={name:"ProcessManage",components:{Pagination:o["a"],"operate-mould":S},data:function(){return{searchKey:{code:"",name:""},loading:!1,showDialog:!1,total:0,pageIndex:1,pageSize:10,currentId:0,objstr:null,multipleSelection:[],list:[]}},computed:{},mounted:function(){this.fetchDate()},methods:{tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===1?"table-row":""},fetchDate:function(){var t=this;this.list=[],this.multipleSelection=[],this.loading=!0;var e={productCode:this.searchKey.code+""?this.searchKey.code:null,productName:this.searchKey.name+""?this.searchKey.name:null,pageNum:this.pageIndex,pageSize:this.pageSize};Object(l["j"])(e).then((function(e){t.loading=!1,0===e.code&&(t.list=e.data.list,t.total=e.data.total)}))},searchBtn:function(){this.fetchDate()},searchrestBtn:function(){this.searchKey={code:"",name:""},this.pageIndex=1,this.pageSize=10,this.fetchDate()},handleSelectionChange:function(t){this.multipleSelection=t},handleCurrentChange:function(){this.fetchDate()},deleteAll:function(){var t=this;if(0===this.multipleSelection.length)return this.$message({message:"请选择需要删除的数据!",type:"warning"}),!1;var e,s=[],a=Object(r["a"])(this.multipleSelection);try{for(a.s();!(e=a.n()).done;){var i=e.value;s.push(i.id)}}catch(o){a.e(o)}finally{a.f()}this.$confirm("确定批量删除吗?","操作提示",{confirmButtonText:"确认删除",cancelButtonText:"取消"}).then((function(){var e={ids:s.join(",")};Object(l["b"])(e).then((function(e){t.loading=!1,0===e.code?(t.$message({message:"删除成功!",type:"success"}),t.list.length===s.length&&t.pageIndex>1&&(t.pageIndex=t.pageIndex-1),t.fetchDate()):1e3===e.code&&t.$message({message:e.msg,type:"error"})}))}))},deleteBtn:function(t){var e=this;this.$confirm("确定删除吗?","操作提示",{confirmButtonText:"确认删除",cancelButtonText:"取消"}).then((function(){var s={ids:t.id};Object(l["b"])(s).then((function(t){e.loading=!1,0===t.code?(e.$message({message:"删除成功!",type:"success"}),1===e.list.length&&e.pageIndex>1&&(e.pageIndex=e.pageIndex-1),e.fetchDate()):1e3===t.code&&e.$message({message:t.msg,type:"error"})}))}))},addBtn:function(){sessionStorage.removeItem("flowJson"),this.objstr={type:"add"},this.showDialog=!0},editBtn:function(t){sessionStorage.removeItem("flowJson"),this.objstr=t,this.objstr.type="edit",this.showDialog=!0},DetailCallBack:function(t){this.showDialog=!1,"1"===t.result&&this.fetchDate()}}},j=k,$=(s("3ee3"),Object(f["a"])(j,a,i,!1,null,"6debb14c",null));e["default"]=$.exports},e58c:function(t,e,s){"use strict";var a=s("fc6a"),i=s("a691"),r=s("50c4"),l=s("a640"),o=s("ae40"),n=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,p=l("lastIndexOf"),m=o("indexOf",{ACCESSORS:!0,1:0}),u=d||!p||!m;t.exports=u?function(t){if(d)return c.apply(this,arguments)||0;var e=a(this),s=r(e.length),l=s-1;for(arguments.length>1&&(l=n(l,i(arguments[1]))),l<0&&(l=s+l);l>=0;l--)if(l in e&&e[l]===t)return l||0;return-1}:c}}]);