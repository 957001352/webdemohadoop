(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31440c66"],{"09f4":function(t,e,o){"use strict";o.d(e,"a",(function(){return l})),Math.easeInOutQuad=function(t,e,o,n){return t/=n/2,t<1?o/2*t*t+e:(t--,-o/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function i(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function a(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(t,e,o){var l=a(),r=t-l,s=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=s;var a=Math.easeInOutQuad(c,l,r,e);i(a),c<e?n(t):o&&"function"===typeof o&&o()};u()}},"0c16":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"filter-container"},[o("span",{staticClass:"seachname"},[t._v("物料代码:")]),o("el-input",{staticClass:"filter-item",attrs:{size:"small",placeholder:"输入物料代码"},model:{value:t.listQuery.materialCode,callback:function(e){t.$set(t.listQuery,"materialCode",e)},expression:"listQuery.materialCode"}}),o("span",{staticClass:"seachname"},[t._v("物料名称:")]),o("el-input",{staticClass:"filter-item",attrs:{size:"small",placeholder:"输入物料名称"},model:{value:t.listQuery.materialName,callback:function(e){t.$set(t.listQuery,"materialName",e)},expression:"listQuery.materialName"}}),o("el-button",{staticClass:"primaryBtn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查询")]),o("el-button",{staticClass:"resetBtn",attrs:{type:"default",icon:"el-icon-refresh-right"},on:{click:t.handleReset}},[t._v("重置")])],1),o("div",{staticClass:"opt-container"},[t.hasPermission("stockInfo/add")?o("el-button",{staticClass:"addBtn",attrs:{type:"default",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAdd}},[t._v("添加备品")]):t._e()],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],key:t.tableKey,ref:"tableRef",attrs:{stripe:"",data:t.stockInfoList,border:"",fit:"","highlight-current-row":"","header-cell-style":t.headerClassName,height:t.tableHeight},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",align:"center",width:"55",fixed:""}}),o("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"55",fixed:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s((t.listQuery.page-1)*t.listQuery.limit+e.$index+1)+" ")]}}])}),o("el-table-column",{attrs:{label:"物料代码",prop:"code","min-width":"150px",align:"center"}}),o("el-table-column",{attrs:{label:"物料名称",prop:"name","min-width":"150px",align:"center","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"单位",prop:"unit",width:"160px",align:"center"}}),o("el-table-column",{attrs:{label:"当前库存",prop:"storeCount",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[o("span",[t._v(t._s(null===n.storeCount?0:n.storeCount))])]}}])}),o("el-table-column",{attrs:{label:"最大安全库存",prop:"maxStore",width:"150px",align:"center"}}),o("el-table-column",{attrs:{label:"最小安全库存",prop:"minStore",width:"150px",align:"center"}}),o("el-table-column",{attrs:{label:"更新时间",prop:"updateTime",width:"180px",align:"center"}}),o("el-table-column",{attrs:{label:"操作",width:"100px",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t.hasPermission("stockInfo/edit")?o("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(e){return t.handleEdit(n)}}},[o("svg-icon",{attrs:{"icon-class":"edit"}}),t._v(" 编辑 ")],1):t._e()]}}])})],1),o("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getStockInfoList}}),t.editDialogVisible?o("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"dialogs",attrs:{title:t.dialogTitle,visible:t.editDialogVisible,"close-on-click-modal":!1,width:"480px"},on:{"update:visible":function(e){t.editDialogVisible=e}}},[o("StockInfoEdit",{attrs:{"stock-info-obj":t.oStockInfo},on:{StockInfoEditCall:t.stockInfoEditCall}})],1):t._e()],1)},i=[],a=(o("4de4"),o("c975"),o("d81d"),o("d3b7"),o("25f0"),o("5530")),l=o("dbcc"),r=o("333d"),s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("el-form",{ref:"stockInfoForm",attrs:{model:t.stockInfoForm,rules:t.rules,"label-width":"110px"}},[o("el-form-item",{attrs:{label:"物料代码",prop:"code"}},[o("el-input",{attrs:{size:"mini",placeholder:"输入物料代码"},on:{input:function(e){t.stockInfoForm.code=t.inputRule(t.stockInfoForm.code)}},model:{value:t.stockInfoForm.code,callback:function(e){t.$set(t.stockInfoForm,"code",e)},expression:"stockInfoForm.code"}})],1),o("el-form-item",{attrs:{label:"物料名称",prop:"name"}},[o("el-input",{attrs:{size:"mini",placeholder:"输入物料名称"},on:{input:function(e){t.stockInfoForm.name=t.inputRule(t.stockInfoForm.name)}},model:{value:t.stockInfoForm.name,callback:function(e){t.$set(t.stockInfoForm,"name",e)},expression:"stockInfoForm.name"}})],1),o("el-form-item",{attrs:{label:"单位",prop:"unit"}},[o("el-input",{attrs:{size:"mini",placeholder:"输入单位"},on:{input:function(e){t.stockInfoForm.unit=t.inputRule(t.stockInfoForm.unit)}},model:{value:t.stockInfoForm.unit,callback:function(e){t.$set(t.stockInfoForm,"unit",e)},expression:"stockInfoForm.unit"}})],1),o("el-form-item",{attrs:{label:"最小安全库存",prop:"minStore"}},[o("el-input-number",{attrs:{size:"mini",min:0},model:{value:t.stockInfoForm.minStore,callback:function(e){t.$set(t.stockInfoForm,"minStore",e)},expression:"stockInfoForm.minStore"}})],1),o("el-form-item",{attrs:{label:"最大安全库存",prop:"maxStore"}},[o("el-input-number",{attrs:{size:"mini",min:0},model:{value:t.stockInfoForm.maxStore,callback:function(e){t.$set(t.stockInfoForm,"maxStore",e)},expression:"stockInfoForm.maxStore"}})],1)],1),o("div",{staticClass:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:t.handleCancel}},[t._v("取消")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleSave}},[t._v("保存")])],1)],1)},c=[],u=(o("b0c0"),o("498a"),{name:"StockInfoEdit",props:{stockInfoObj:{type:Object,required:!1}},data:function(){var t=this;return{handleType:"添加",stockInfoForm:{code:"",name:"",unit:"",maxStore:0,minStore:0},rules:{code:[{required:!0,message:"请输入物料代码",trigger:"blur"},{validator:function(t,e,o){var n=e.trim();n.length<1||n.length>20?o(new Error("物料代码必须是1~20个字符")):o()},trigger:"blur"}],name:[{required:!0,message:"请输入物料名称",trigger:"blur"},{validator:function(t,e,o){var n=e.trim();n.length<1||n.length>20?o(new Error("物料名称必须是1~20个字符")):o()},trigger:"blur"}],unit:[{required:!0,message:"请输入单位",trigger:"blur"},{validator:function(t,e,o){var n=e.trim();n.length<1||n.length>20?o(new Error("单位必须是1~20个字符")):o()},trigger:"blur"}],minStore:[{required:!0,message:"请输入最小安全库存",trigger:"blur"},{validator:function(e,o,n){var i=o;i>t.stockInfoForm.maxStore?n(new Error("最小安全库存不能超过最大安全库存")):n()},trigger:"blur"}],maxStore:[{required:!0,message:"请输入最大安全库存",trigger:"blur"},{validator:function(e,o,n){var i=o;i.length<t.stockInfoForm.minStore?n(new Error("最大安全库存不能低于最小安全库存")):n()},trigger:"blur"}]}}},created:function(){void 0===this.stockInfoObj.id?this.handleType="添加":(this.handleType="修改",this.stockInfoForm=Object(a["a"])({},this.stockInfoObj))},methods:{handleCancel:function(){this.$emit("StockInfoEditCall",!1)},handleSave:function(){var t=this;this.$refs.stockInfoForm.validate((function(e){if(!e)return!1;t.handleSetStock()}))},handleSetStock:function(){var t=this,e={code:this.stockInfoForm.code,name:this.stockInfoForm.name,unit:this.stockInfoForm.unit,minStore:this.stockInfoForm.minStore,maxStore:this.stockInfoForm.maxStore};"修改"===this.handleType&&(e["id"]=this.stockInfoForm.id,e["storeCount"]=this.stockInfoForm.storeCount),Object(l["b"])(e).then((function(e){0===e.code?(t.$message({message:"备品"+t.handleType+"成功!",type:"success"}),t.$emit("StockInfoEditCall",!0)):1e3===e.code&&t.$message({message:"备品"+t.handleType+"失败:"+e.msg,type:"error"})}))}}}),d=u,m=(o("83ee"),o("2877")),f=Object(m["a"])(d,s,c,!1,null,"38e8cff5",null),p=f.exports,h=o("a888"),g={name:"StockInfo",directives:{elDragDialog:h["a"]},components:{Pagination:r["a"],StockInfoEdit:p},data:function(){return{total:0,listQuery:{page:1,limit:10,materialCode:"",materialName:""},tableHeight:0,tableKey:0,tableLoading:!0,stockInfoList:[],multipleSelection:[],oStockInfo:{},editDialogVisible:!1,dialogTitle:"添加备品"}},watch:{checkboxVal:function(t){this.formThead=this.formTheadOptions.filter((function(e){return t.indexOf(e)>=0})),this.key=this.key+1}},created:function(){var t=this;this.getStockInfoList(),this.computedTableHeight(),window.onresize=function(){return function(){t.computedTableHeight()}()}},methods:{headerClassName:function(t){t.row,t.rowIndex;return"background-color: #FAFAFA"},stockInfoEditCall:function(t){this.editDialogVisible=!1,t&&this.getStockInfoList()},handleFilter:function(){this.listQuery.page=1,this.getStockInfoList()},handleReset:function(){this.listQuery.page=1,this.listQuery.materialCode="",this.listQuery.materialName="",this.getStockInfoList()},handleAdd:function(){this.oStockInfo={},this.dialogTitle="添加备品",this.editDialogVisible=!0},handleEdit:function(t){this.dialogTitle="编辑备品",this.oStockInfo=Object(a["a"])({},t),this.editDialogVisible=!0},handleDelte:function(){var t=this,e=this.optSelectedTable();0!==e.length?this.$confirm("确定删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRequestById(e.toString())})):this.$message({message:"您还没有选择数据!",type:"warning"})},handleSelectionChange:function(t){this.multipleSelection=t},getStockInfoList:function(){var t=this;this.tableLoading=!0;var e={pageNum:this.listQuery.page,pageSize:this.listQuery.limit,code:this.listQuery.materialCode,name:this.listQuery.materialName};Object(l["c"])(e).then((function(e){0===e.code&&(t.stockInfoList=e.data.list,t.total=e.data.total),t.tableLoading=!1}))},deleteRequestById:function(t){var e=this;this.tableLoading=!0,Object(l["a"])(t).then((function(t){e.tableLoading=!1,0===t.code&&e.getStockInfoList()}))},optSelectedTable:function(){var t=[];return this.multipleSelection.length>0&&this.multipleSelection.map((function(e,o){t.push(e.id)})),t},computedTableHeight:function(){var t=document.body.clientHeight;t=t<768?768:t,this.tableHeight=t-352}}},b=g,k=(o("4c79"),Object(m["a"])(b,n,i,!1,null,"1a8fa3f0",null));e["default"]=k.exports},"4c79":function(t,e,o){"use strict";var n=o("504d"),i=o.n(n);i.a},"504d":function(t,e,o){},7230:function(t,e,o){},"83ee":function(t,e,o){"use strict";var n=o("7230"),i=o.n(n);i.a},a888:function(t,e,o){"use strict";o("99af"),o("caad"),o("ac1f"),o("2532"),o("5319");var n={bind:function(t,e,o){var n=t.querySelector(".el-dialog__header"),i=t.querySelector(".el-dialog");n.style.cssText+=";cursor:move;",i.style.cssText+=";top:0px;";var a=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();n.onmousedown=function(t){var e=t.clientX-n.offsetLeft,l=t.clientY-n.offsetTop,r=i.offsetWidth,s=i.offsetHeight,c=document.body.clientWidth,u=document.body.clientHeight,d=i.offsetLeft,m=c-i.offsetLeft-r,f=i.offsetTop,p=u-i.offsetTop-s,h=a(i,"left"),g=a(i,"top");h.includes("%")?(h=+document.body.clientWidth*(+h.replace(/\%/g,"")/100),g=+document.body.clientHeight*(+g.replace(/\%/g,"")/100)):(h=+h.replace(/\px/g,""),g=+g.replace(/\px/g,"")),document.onmousemove=function(t){var n=t.clientX-e,a=t.clientY-l;-n>d?n=-d:n>m&&(n=m),-a>f?a=-f:a>p&&(a=p),i.style.cssText+=";left:".concat(n+h,"px;top:").concat(a+g,"px;"),o.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}},i=function(t){t.directive("el-drag-dialog",n)};window.Vue&&(window["el-drag-dialog"]=n,Vue.use(i)),n.install=i;e["a"]=n},dbcc:function(t,e,o){"use strict";o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return a})),o.d(e,"b",(function(){return l}));var n=o("b775");function i(t){return Object(n["a"])({url:window.configs.api+"/productDevicesSpare/findList",method:"get",params:t})}function a(t){return Object(n["a"])({url:window.configs.api+"/productDevicesSpare/delete",method:"get",params:{ids:t}})}function l(t){return Object(n["a"])({url:window.configs.api+"/productDevicesSpare/save",method:"post",data:t})}}}]);