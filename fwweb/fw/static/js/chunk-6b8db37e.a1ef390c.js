(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b8db37e"],{"09f4":function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,i,s){return e/=s/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var s=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function a(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,i){var o=l(),n=e-o,r=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=r;var l=Math.easeInOutQuad(c,o,n,t);a(l),c<t?s(e):i&&"function"===typeof i&&i()};u()}},5077:function(e,t,i){"use strict";var s=i("a56a"),a=i.n(s);a.a},a56a:function(e,t,i){},d46a:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"searchInfo"},[i("span",{staticClass:"seachname"},[e._v(" 维修工单号: ")]),i("el-input",{staticClass:"inputCls",staticStyle:{"margin-right":"15px"},attrs:{placeholder:"请输入维修工单号",clearable:""},model:{value:e.searchKey.name,callback:function(t){e.$set(e.searchKey,"name",t)},expression:"searchKey.name"}}),i("span",{staticClass:"seachname"},[e._v(" 设备编号: ")]),i("el-input",{staticClass:"inputCls",staticStyle:{"margin-right":"15px"},attrs:{placeholder:"请输入设备编号",clearable:""},model:{value:e.searchKey.number,callback:function(t){e.$set(e.searchKey,"number",t)},expression:"searchKey.number"}}),i("span",{staticClass:"seachname"},[e._v(" 设备类型: ")]),i("el-select",{staticClass:"inputCls",staticStyle:{"margin-right":"15px"},attrs:{placeholder:"请选择设备类型",clearable:""},model:{value:e.searchKey.type,callback:function(t){e.$set(e.searchKey,"type",t)},expression:"searchKey.type"}},e._l(e.maintainObjList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.classifyName,value:e.classifyId}})})),1),i("el-button",{staticClass:"primaryBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"primary"},on:{click:e.searchBtn}},[i("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" 查询 ")],1),i("el-button",{staticClass:"resetBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"default",icon:"el-icon-refresh-right"},on:{click:e.searchrestBtn}},[e._v(" 重置 ")])],1),i("div",{staticClass:"searchInfo"},[e.hasPermission("programmeImplement/add")?i("el-button",{staticClass:"addBtn",attrs:{type:"default",icon:"el-icon-plus"},on:{click:e.addBtn}},[e._v(" 设备维修申请")]):e._e()],1),i("div",{staticClass:"el-tablenew"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,"row-class-name":e.tableRowClassName,border:"",height:"calc(100vh - 337px)"}},[i("el-table-column",{attrs:{prop:"code","min-width":"180px",label:"维修工单编号",align:"center",fixed:"","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"devicesName",label:"设备编号",width:"150px",align:"center"}}),i("el-table-column",{attrs:{prop:"classifyName",label:"设备类型",width:"120px",align:"center"}}),i("el-table-column",{attrs:{prop:"questionName","min-width":"120px",label:"问题",align:"center","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"priority",label:"优先级",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("0"===t.row.priority?"普通":"优先")+" ")]}}])}),i("el-table-column",{attrs:{prop:"createUserName",label:"申请人",align:"center"}}),i("el-table-column",{attrs:{prop:"planHour",label:"预计耗时",align:"center"}}),i("el-table-column",{attrs:{prop:"date",label:"方案制定状态",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(0===t.row.repairProjectStatus?"未制定":"已制定")+" ")]}}])}),i("el-table-column",{attrs:{prop:"date",label:"任务执行状态",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(0===t.row.repairTaskExeStatus?"未执行":"已执行")+" ")]}}])}),i("el-table-column",{attrs:{prop:"date",label:"操作",width:"250px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticClass:"defaultTextBtn",attrs:{type:"text"},on:{click:function(i){return e.implenmentNo(t.row,"find")}}},[i("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" 查看 ")],1),e.hasPermission("programmeImplement/edit")&&1!==t.row.repairTaskExeStatus&&0===t.row.taskReceived?i("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(i){return e.implenmentNo(t.row,"set")}}},[i("svg-icon",{attrs:{"icon-class":"edit"}}),e._v(" 制定方案 ")],1):e._e(),e.hasPermission("programmeImplement/get")&&1===t.row.repairProjectStatus&&0===t.row.taskReceived&&1!==t.row.repairTaskExeStatus?i("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(i){return e.implenmentNo(t.row,"task")}}},[i("svg-icon",{attrs:{"icon-class":"renwu"}}),e._v(" 领取任务 ")],1):e._e(),e.hasPermission("programmeImplement/go")&&1===t.row.taskReceived&&1!==t.row.repairTaskExeStatus&&1===t.row.repairProjectStatus?i("el-button",{staticClass:"otherTextBtn",attrs:{type:"text"},on:{click:function(i){return e.implenmentNo(t.row,"go")}}},[i("svg-icon",{attrs:{"icon-class":"zhixing"}}),e._v(" 执行 ")],1):e._e(),e.hasPermission("programmeImplement/delete")&&0===t.row.repairProjectStatus?i("el-button",{staticClass:"deleteTextBtn",attrs:{type:"text"},on:{click:function(i){return e.deleteBtn(t.row)}}},[i("svg-icon",{attrs:{"icon-class":"delete"}}),e._v(" 删除 ")],1):e._e()]}}])})],1),i("pagination",{staticClass:"pagePadd",attrs:{total:e.total,page:e.pageIndex,limit:e.pageSize},on:{"update:page":function(t){e.pageIndex=t},"update:limit":function(t){e.pageSize=t},pagination:e.handleCurrentChange}})],1),i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"dialogs",attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,title:"设备维修申请",width:"665px"},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.resetFrom("forms")}}},[i("el-form",{ref:"forms",attrs:{model:e.forms,rules:e.rules,"label-position":"left","label-width":"120px"}},[i("el-form-item",{attrs:{label:"设备编号",prop:"productDevicesId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"设备编号",size:"small",filterable:""},on:{change:function(t){return e.setClassIfy()}},model:{value:e.forms.productDevicesId,callback:function(t){e.$set(e.forms,"productDevicesId",t)},expression:"forms.productDevicesId"}},e._l(e.codeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"问题",prop:"question"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"问题",size:"small",filterable:"",multiple:"","collapse-tags":""},model:{value:e.forms.question,callback:function(t){e.$set(e.forms,"question",t)},expression:"forms.question"}},e._l(e.qsList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"设备类型",prop:"devicesClassify"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"设备类型",size:"small"},model:{value:e.forms.devicesClassify,callback:function(t){e.$set(e.forms,"devicesClassify",t)},expression:"forms.devicesClassify"}},e._l(e.maintainObjList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.classifyName,value:e.classifyId}})})),1)],1),i("el-form-item",{attrs:{label:"优先级",prop:"priority"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"优先级",size:"small"},model:{value:e.forms.priority,callback:function(t){e.$set(e.forms,"priority",t)},expression:"forms.priority"}},e._l(e.priorityList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"问题描述",prop:"questionDesc"}},[i("el-input",{attrs:{rows:5,resize:"none",type:"textarea",placeholder:"请输入问题描述",maxlength:"20"},model:{value:e.forms.questionDesc,callback:function(t){e.$set(e.forms,"questionDesc",t)},expression:"forms.questionDesc"}})],1),i("el-form-item",{attrs:{label:"维修前照片",prop:"beforeFile"}},[i("el-upload",{attrs:{action:"",limit:4,"file-list":e.fileList,"before-upload":e.beforeFile,"http-request":e.uploadImage,"list-type":"picture-card"},scopedSlots:e._u([{key:"file",fn:function(t){var s=t.file;return i("div",{},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:e.uploadImg+s.webPath,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(s)}}},[i("i",{staticClass:"el-icon-zoom-in"})]),i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(s)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}])},[i("i",{staticClass:"el-icon-plus"})]),i("el-input",{staticStyle:{display:"none"},model:{value:e.forms.beforeFile,callback:function(t){e.$set(e.forms,"beforeFile",t)},expression:"forms.beforeFile"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"defaultBtn",staticStyle:{width:"120px","border-radius":"4px"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),i("el-button",{staticClass:"primaryBtn",staticStyle:{width:"120px"},attrs:{disabled:e.disabled,type:"primary"},on:{click:function(t){return e.submitForm("forms")}}},[e._v("确定")])],1),i("el-dialog",{attrs:{visible:e.dialogImgVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogImgVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e.implementdialogVisible?i("div",{staticClass:"repairsty"},[i("get-repair",{attrs:{objstr:e.objstr},on:{DetailCallBack:e.DetailCallBack}})],1):e._e()],1)},a=[],l=(i("a15b"),i("baa5"),i("a434"),i("b0c0"),i("b85c")),o=i("0adb"),n=i("6ace"),r=i("333d"),c=i("a888"),u=i("3da2"),d={name:"ProgrammeImplement",directives:{elDragDialog:c["a"]},components:{Pagination:r["a"],"get-repair":u["a"]},data:function(){return{loading:!1,dialogVisible:!1,setdialogVisiblese:!1,implementdialogVisible:!1,infoDialogvisible:!1,dialogImgVisible:!1,dialogImageUrl:"",activeName:"first",radio:"1",disabled:!1,objstr:"",dialogTitle:"",searchKey:{name:"",number:"",type:""},codeList:[],sparePart:[],uploadImg:window.configs.api,total:0,pageIndex:1,pageSize:10,currentId:0,multipleSelection:[],maintainObjList:[],qsList:[],forms:{productDevicesId:"",question:[],questionDesc:"",devicesClassify:"",priority:"",beforeFile:""},priorityList:[{id:0,name:"普通"},{id:1,name:"优先"}],rules:{productDevicesId:[{required:!0,message:"请选择设备编号",trigger:"blur"}],question:[{required:!0,message:"请选择问题",trigger:"blur"}],questionDesc:[{required:!0,message:"请输入问题描述",trigger:"blur"}],devicesClassify:[{required:!0,message:"请选择设备类型",trigger:"blur"}],priority:[{required:!0,message:"请选择优先级",trigger:"blur"}],beforeFile:[{required:!0,message:"请上传维修前照片",trigger:"blur"}]},fileList:[],list:[]}},computed:{},mounted:function(){this.getDevicesClassifys(),this.fetchDate()},methods:{beforeRemove:function(){},getDevicesClassifys:function(){var e=this;Object(o["e"])().then((function(t){e.maintainObjList=t.data?t.data:[]}))},questionLists:function(){var e=this;Object(o["h"])({type:1,pageNum:1,pageSize:99999}).then((function(t){e.qsList=t.data.list?t.data.list:[]}))},findDevicesLists:function(){var e=this;Object(n["a"])({}).then((function(t){e.codeList=t.data?t.data:[]}))},handleClick:function(e,t){console.log(e,t)},DetailCallBack:function(e){this.implementdialogVisible=!1,"1"===e.result&&this.fetchDate()},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2===1?"table-row":""},handleSelectionChange:function(e){this.multipleSelection=e},fetchDate:function(){var e=this;this.list=[],this.loading=!0;var t={code:this.searchKey.name+""?this.searchKey.name:null,productDevicesId:this.searchKey.number+""?this.searchKey.number:null,devicesClassify:this.searchKey.type+""?this.searchKey.type:null,pageNum:this.pageIndex,pageSize:this.pageSize};Object(o["b"])(t).then((function(t){e.loading=!1,0===t.code&&(console.log(t),e.list=t.data.list,e.total=t.data.total)})),console.log(this.list)},searchBtn:function(){this.fetchDate()},searchrestBtn:function(){this.searchKey={name:"",number:"",type:""},this.pageIndex=1,this.pageSize=10,this.fetchDate()},handleCurrentChange:function(){this.fetchDate()},handleRemove:function(e){this.forms.beforeFile="";for(var t=0;t<this.fileList.length;t++){if(this.fileList[t].webPath===e.webPath){this.fileList.splice(t,1);break}this.forms.beforeFile?this.forms.beforeFile=this.forms.beforeFile+","+e.webPath:this.forms.beforeFile=e.webPath}},setClassIfy:function(){var e,t=Object(l["a"])(this.codeList);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(i.id===this.forms.productDevicesId){this.forms.devicesClassify=i.classifyId;break}}}catch(s){t.e(s)}finally{t.f()}},addBtn:function(){this.dialogTitle="设备维修申请",this.questionLists(),this.findDevicesLists(),this.fileList=[],this.forms={productDevicesId:"",question:[],questionDesc:"",devicesClassify:"",priority:"",beforeFile:""},this.dialogVisible=!0},handlePictureCardPreview:function(e){this.dialogImageUrl=this.uploadImg+e.webPath,this.dialogImgVisible=!0},uploadImage:function(e){var t=this,i=new FormData;i.append("file",e.file),i.append("isAdd",!0),Object(n["c"])(i).then((function(e){if(0===e.code){t.fileList.push(e.data),t.forms.beforeFile?t.forms.beforeFile=t.forms.beforeFile+","+e.data.webPath:t.forms.beforeFile=e.data.webPath;var i=t;setTimeout((function(){i.$refs.forms.validateField("beforeFile")}),500),t.$message({type:"success",message:"上传成功！"})}}))},beforeFile:function(e){var t=e.name,i=t.substring(t.lastIndexOf(".")+1).toLowerCase();if("png"!==i&&"jpg"!==i&&"jpeg"!==i)return this.$message({type:"warning",message:"请上传png/jpg/jpeg格式图片！"}),!1;var s=e.size/1024/1024<200;return s?this.fileList.length>3?(this.$message.error("上传图片个数不能超过4个!"),!1):void 0:(this.$message.error("上传图片大小不能超过 200MB!"),!1)},setInfos:function(e){this.setdialogVisiblese=!0},implenmentNo:function(e,t){var i=JSON.parse(JSON.stringify(e));i.type=t,this.objstr=JSON.stringify(i),this.implementdialogVisible=!0},getInfoNo:function(e){this.infoDialogvisible=!0},deleteBtn:function(e){var t=this;this.$confirm("确定删除吗?","操作提示",{confirmButtonText:"确认删除",cancelButtonText:"取消"}).then((function(){var i={ids:e.id};Object(o["i"])(i).then((function(e){t.loading=!1,0===e.code?(t.$message({message:"删除成功!",type:"success"}),1===t.list.length&&t.pageIndex>1&&(t.pageIndex=t.pageIndex-1),t.fetchDate()):1e3===e.code&&t.$message({message:e.msg,type:"error"})}))}))},exportExcel:function(){var e="",t=window.open(encodeURI(e));setTimeout((function(){t.close()}),1e3)},resetFrom:function(e){this.$refs[e].resetFields()},submitForm:function(e){var t=this;this.$refs[e].validate((function(i){if(i){var s={productDevicesId:t.forms.productDevicesId,question:t.forms.question.join(","),questionDesc:t.forms.questionDesc,devicesClassify:t.forms.devicesClassify,priority:t.forms.priority,beforeFile:t.forms.beforeFile};Object(o["j"])(s).then((function(i){0===i.code?(t.$message({message:"操作成功!",type:"success"}),t.dialogVisible=!1,t.fetchDate(),t.$refs[e].resetFields()):1e3===i.code&&t.$message({message:i.msg,type:"error"})}))}}))}}},m=d,p=(i("5077"),i("2877")),f=Object(p["a"])(m,s,a,!1,null,"1fd2dbce",null);t["default"]=f.exports}}]);