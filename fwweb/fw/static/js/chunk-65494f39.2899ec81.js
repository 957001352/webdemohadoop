(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65494f39"],{"09f4":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),Math.easeInOutQuad=function(e,t,n,i){return e/=i/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function a(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,n){var s=a(),r=e-s,c=20,l=0;t="undefined"===typeof t?500:t;var u=function e(){l+=c;var a=Math.easeInOutQuad(l,s,r,t);o(a),l<t?i(e):n&&"function"===typeof n&&n()};u()}},2423:function(e,t,n){"use strict";n.d(t,"p",(function(){return o})),n.d(t,"h",(function(){return a})),n.d(t,"l",(function(){return s})),n.d(t,"c",(function(){return r})),n.d(t,"t",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"u",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"o",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"q",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return w})),n.d(t,"r",(function(){return v})),n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return k})),n.d(t,"m",(function(){return T})),n.d(t,"i",(function(){return x})),n.d(t,"s",(function(){return j})),n.d(t,"v",(function(){return L}));var i=n("b775");function o(e){return Object(i["a"])({url:window.configs.api+"/jbpmDeployment/findList",method:"get",params:e})}function a(e){return Object(i["a"])({url:window.configs.api+"/jbpmDeployment/save",method:"post",data:e})}function s(){return Object(i["a"])({url:window.configs.api+"/jbpmDeployment/findJbpmFormList",method:"get"})}function r(e){return Object(i["a"])({url:window.configs.api+"/jbpmDeployment/delete",method:"get",params:{ids:e}})}function c(){return Object(i["a"])({url:window.configs.e2cUrl+"/user/findList",method:"get"})}function l(e){return Object(i["a"])({url:window.configs.api+"/jbpmExecution/findWaitTaskList",method:"get",params:e})}function u(e){return Object(i["a"])({url:window.configs.api+"/jbpmExecution/findHistTaskList",method:"get",params:e})}function d(e,t){return Object(i["a"])({url:window.configs.api+"/devicesRepai/findList",method:"get",params:{id:e}})}function f(e){return Object(i["a"])({url:window.configs.api+"/jbpmExecution/findHistTaskDeatilList",method:"get",params:e})}function m(e){return Object(i["a"])({url:window.configs.api+"/jbpmExecution/doTask",method:"post",data:e})}function p(e){return Object(i["a"])({url:window.configs.api+"/devicesKeepTask/getDevicesKeepTask",method:"get",params:{id:e}})}function h(e){return Object(i["a"])({url:window.configs.api+"/devicesScrap/findList",method:"get",params:{devicesScrapId:e}})}function g(e){return Object(i["a"])({url:window.configs.api+"/devicesCheckTeam/findList",method:"get",params:e})}function b(e){return Object(i["a"])({url:window.configs.api+"/devicesCheckTeam/save",method:"post",data:e})}function w(e){return Object(i["a"])({url:window.configs.api+"/devicesCheckTeam/delete",method:"get",params:{ids:e}})}function v(e){return Object(i["a"])({url:window.configs.api+"/devicesCheckItem/findList",method:"get",params:e})}function y(e){return Object(i["a"])({url:window.configs.api+"/devicesCheckItem/save",method:"post",data:e})}function k(e){return Object(i["a"])({url:window.configs.api+"/devicesCheckItem/delete",method:"get",params:{ids:e}})}function T(){return Object(i["a"])({url:window.configs.e2cUrl+"/devicesClassify/findList",method:"get"})}function x(e){return Object(i["a"])({url:window.configs.e2cUrl+"/productDevices/findList",method:"get",param:e})}function j(e){return Object(i["a"])({url:window.configs.api+"/devicesCheck/findList",method:"get",params:e})}function L(e){return Object(i["a"])({url:window.configs.api+"/mouldDevices/findOneById",method:"get",params:{id:e}})}},"9a5d":function(e,t,n){},a82a:function(e,t,n){"use strict";var i=n("9a5d"),o=n.n(i);o.a},a888:function(e,t,n){"use strict";n("99af"),n("caad"),n("ac1f"),n("2532"),n("5319");var i={bind:function(e,t,n){var i=e.querySelector(".el-dialog__header"),o=e.querySelector(".el-dialog");i.style.cssText+=";cursor:move;",o.style.cssText+=";top:0px;";var a=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}();i.onmousedown=function(e){var t=e.clientX-i.offsetLeft,s=e.clientY-i.offsetTop,r=o.offsetWidth,c=o.offsetHeight,l=document.body.clientWidth,u=document.body.clientHeight,d=o.offsetLeft,f=l-o.offsetLeft-r,m=o.offsetTop,p=u-o.offsetTop-c,h=a(o,"left"),g=a(o,"top");h.includes("%")?(h=+document.body.clientWidth*(+h.replace(/\%/g,"")/100),g=+document.body.clientHeight*(+g.replace(/\%/g,"")/100)):(h=+h.replace(/\px/g,""),g=+g.replace(/\px/g,"")),document.onmousemove=function(e){var i=e.clientX-t,a=e.clientY-s;-i>d?i=-d:i>f&&(i=f),-a>m?a=-m:a>p&&(a=p),o.style.cssText+=";left:".concat(i+h,"px;top:").concat(a+g,"px;"),n.child.$emit("dragDialog")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},o=function(e){e.directive("el-drag-dialog",i)};window.Vue&&(window["el-drag-dialog"]=i,Vue.use(o)),i.install=o;t["a"]=i},acac:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"k",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"e",(function(){return p}));var i=n("b775");function o(e){return Object(i["a"])({url:window.configs.api+"/logisticsMoveHouse/findList",method:"get",params:e})}function a(e){return Object(i["a"])({url:window.configs.api+"/logisticsMoveHouse/save",method:"post",data:e})}function s(e){return Object(i["a"])({url:window.configs.api+"/logisticsProduct/findDetailList",method:"get",params:e})}function r(e){return Object(i["a"])({url:window.configs.api+"/logisticsStorageHouse/findStorageLocationList",method:"get",params:e})}function c(e){return Object(i["a"])({url:window.configs.api+"/logisticsMoveHouse/delete",method:"get",params:e})}function l(e){return Object(i["a"])({url:window.configs.api+"/logisticsTakeOrder/findList",method:"get",params:e})}function u(e){return Object(i["a"])({url:window.configs.api+"/logisticsCheckHouse/findList",method:"get",params:e})}function d(e){return Object(i["a"])({url:window.configs.api+"/logisticsCheckHouse/findDetailList",method:"get",params:e})}function f(e){return Object(i["a"])({url:window.configs.api+"/logisticsCheckHouse/updateStatus",method:"get",params:e})}function m(e){return Object(i["a"])({url:window.configs.api+"/logisticsCheckHouse/insert",method:"post",data:e})}function p(){return Object(i["a"])({url:window.configs.api+"/logisticsCheckHouse/findTreeList",method:"get"})}},eaae:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"searchInfo"},[n("span",{staticClass:"seachname"},[e._v(" 盘点单号: ")]),n("el-input",{staticClass:"inputCls",staticStyle:{"margin-right":"15px"},attrs:{placeholder:"请输入盘点单号",clearable:""},model:{value:e.searchKey.name,callback:function(t){e.$set(e.searchKey,"name",t)},expression:"searchKey.name"}}),n("span",{staticClass:"seachname"},[e._v(" 盘点日期: ")]),n("el-date-picker",{staticClass:"inputCls",staticStyle:{width:"150px","margin-right":"15px"},attrs:{editable:!1,type:"date",placeholder:"盘点日期",clearable:""},model:{value:e.searchKey.startTime,callback:function(t){e.$set(e.searchKey,"startTime",t)},expression:"searchKey.startTime"}}),n("span",{staticClass:"seachname"},[e._v(" 盘点结果: ")]),n("el-select",{staticClass:"inputCls",staticStyle:{width:"120px","margin-right":"15px"},attrs:{placeholder:"盘点结果",clearable:""},model:{value:e.searchKey.status,callback:function(t){e.$set(e.searchKey,"status",t)},expression:"searchKey.status"}},e._l(e.priorityList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1),n("el-button",{staticClass:"primaryBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"primary"},on:{click:e.searchBtn}},[n("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" 查询 ")],1),n("el-button",{staticClass:"resetBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"default",icon:"el-icon-refresh-right"},on:{click:e.searchrestBtn}},[e._v(" 重置 ")])],1),n("div",{staticClass:"searchInfo"},[e.hasPermission("inventory/add")?n("el-button",{staticClass:"addBtn",attrs:{type:"default",icon:"el-icon-plus"},on:{click:e.addBtn}},[e._v(" 新建临时盘点任务")]):e._e()],1),n("div",{staticClass:"el-tablenew"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,"row-class-name":e.tableRowClassName,border:"",height:"calc(100vh - 337px)"}},[n("el-table-column",{attrs:{prop:"date",label:"序号",width:"55",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1)+" ")]}}])}),n("el-table-column",{attrs:{prop:"houseNo","min-width":"150px",label:"盘点单号",align:"center","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"createTime",label:"计划盘点日期",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.createTime&&t.row.createTime.length>10?t.row.createTime.substring(0,16):t.row.createTime)+" ")]}}])}),n("el-table-column",{attrs:{prop:"executeTime",label:"实际盘点日期",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.executeTime&&t.row.executeTime.length>10?t.row.executeTime.substring(0,16):t.row.executeTime)+" ")]}}])}),n("el-table-column",{attrs:{prop:"priority",label:"盘点结果",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(0===t.row.checkResult?"正常":"异常")+" ")]}}])}),n("el-table-column",{attrs:{prop:"",label:"状态",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(0===t.row.status?"未执行":1===t.row.status?"已执行":"关闭")+" ")]}}])}),n("el-table-column",{attrs:{prop:"note",label:"备注",align:"center"}}),n("el-table-column",{attrs:{prop:"date",label:"操作",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{staticClass:"defaultTextBtn",attrs:{type:"text"},on:{click:function(n){return e.findInfo(t.row)}}},[n("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" 查看 ")],1),0===t.row.status&&e.hasPermission("inventory/close")?n("el-button",{staticClass:"deleteTextBtn",attrs:{type:"text"},on:{click:function(n){return e.setBtn(t.row,1)}}},[n("svg-icon",{attrs:{"icon-class":"jinyong"}}),e._v(" 关闭 ")],1):e._e()]}}])})],1),n("pagination",{staticClass:"pagePadd",attrs:{total:e.total,page:e.pageIndex,limit:e.pageSize},on:{"update:page":function(t){e.pageIndex=t},"update:limit":function(t){e.pageSize=t},pagination:e.handleCurrentChange}})],1),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"dialogs",attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,title:"新建盘点任务",width:"665px"},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.resetFrom("forms")}}},[n("el-form",{ref:"forms",attrs:{model:e.forms,rules:e.rules,"label-position":"left","label-width":"120px"}},[n("el-form-item",{attrs:{label:"计划盘点日期",prop:"startTime"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{editable:!1,"picker-options":e.newPickerOptions,size:"small",type:"date",placeholder:"盘点日期"},model:{value:e.forms.startTime,callback:function(t){e.$set(e.forms,"startTime",t)},expression:"forms.startTime"}})],1),n("el-form-item",{attrs:{label:"盘点人",prop:"person"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"盘点人",size:"small",filterable:""},model:{value:e.forms.person,callback:function(t){e.$set(e.forms,"person",t)},expression:"forms.person"}},e._l(e.userList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),n("div",[n("tree-transfer",{attrs:{title:["源列表","目标列表"],from_data:e.fromData,to_data:e.toData,"default-props":{label:"label"},mode:e.mode,height:"540px",filter:"","open-all":""},on:{addBtn:e.add,removeBtn:e.remove}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticClass:"defaultBtn",staticStyle:{width:"120px","border-radius":"4px"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),n("el-button",{staticClass:"primaryBtn",staticStyle:{width:"120px"},attrs:{disabled:e.disabled,type:"primary"},on:{click:function(t){return e.submitForm("forms")}}},[e._v("确定")])],1)],1),n("el-dialog",{staticClass:"dialogs",attrs:{visible:e.infoDialogvisible,"close-on-click-modal":!1,title:"查看盘点任务",width:"800px"},on:{"update:visible":function(t){e.infoDialogvisible=t}}},[n("el-row",{staticStyle:{"margin-bottom":"15px"}},[n("el-col",{attrs:{span:7}},[e._v(" 单号："+e._s(e.itemInfo.houseNo)+" ")]),n("el-col",{attrs:{span:8}},[e._v(" 盘点时间："+e._s(e.itemInfo.executeTime)+" ")]),n("el-col",{attrs:{span:4}},[e._v(" 盘点人："+e._s(e.itemInfo.checkUserName)+" ")])],1),n("div",{staticClass:"el-tablenew"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.itemInfo.checkHouseDetailList,"row-class-name":e.tableRowClassName,border:""}},[n("el-table-column",{attrs:{prop:"date",label:"序号",width:"55",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1)+" ")]}}])}),n("el-table-column",{attrs:{prop:"storageName",label:"库位",align:"center"}}),n("el-table-column",{attrs:{prop:"productCode",label:"物料代码",align:"center"}}),n("el-table-column",{attrs:{prop:"productName",label:"物料名称",align:"center"}}),n("el-table-column",{attrs:{prop:"storageCount",label:"系统数量",align:"center",width:"100px"}}),n("el-table-column",{attrs:{prop:"checkCount",label:"盘点数量",align:"center",width:"100px"}}),n("el-table-column",{attrs:{prop:"checkResult",label:"结果",align:"center",width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(0===t.row.checkResult?"正常":"异常")+" ")]}}])})],1)],1),n("el-row",{staticStyle:{"margin-top":"15px"}},[n("el-col",{attrs:{span:24}},[e._v(" 备注："+e._s(e.itemInfo.note)+" ")])],1)],1)],1)},o=[],a=(n("4160"),n("a15b"),n("b0c0"),n("159b"),n("b85c")),s=n("acac"),r=n("2423"),c=n("ed08"),l=n("333d"),u=n("a888"),d=n("4c70"),f=n.n(d),m={name:"Inventory",directives:{elDragDialog:u["a"]},components:{Pagination:l["a"],treeTransfer:f.a},data:function(){return{loading:!1,dialogVisible:!1,infoDialogvisible:!1,disabled:!1,objstr:"",dialogTitle:"",newPickerOptions:{disabledDate:function(e){return e.getTime()<new Date(Object(c["b"])(new Date,"{y}-{m}-{d}")+" 00:00:00").getTime()}},searchKey:{name:"",startTime:"",endTime:"",status:""},total:0,pageIndex:1,pageSize:10,currentId:0,forms:{startTime:"",person:""},priorityList:[{id:0,name:"正常"},{id:1,name:"异常"}],rules:{startTime:[{required:!0,message:"请选择盘点日期",trigger:"blur"}],person:[{required:!0,message:"请选择盘点人",trigger:"blur"}]},fileList:[],list:[],itemInfo:{checkHouseDetailList:[],checkHouseIds:"",checkHouseNames:"",checkTime:"",checkUser:"",checkUserName:"",createTime:"",createUser:"",executeTime:"",executeUser:"",houseNo:"",id:"",note:"",status:""},mode:"transfer",fromData:[],toData:[],setList:[],userList:[]}},computed:{},mounted:function(){this.fetchDate(),this.getUserListRequest()},methods:{changeMode:function(){"transfer"===this.mode?this.mode="addressList":this.mode="transfer"},add:function(e,t,n){console.log("fromData:",e),console.log("toData:",t),console.log("obj:",n),this.setList=[],this.getFromList(t),console.log(this.setList)},remove:function(e,t,n){console.log("fromData:",e),console.log("toData:",t),console.log("obj:",n),this.setList=[],this.getFromList(t),console.log(this.setList)},getFromList:function(e){var t,n=Object(a["a"])(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.children?this.getFromList(i.children):this.setList.push(i.id.substring(1,i.id.length))}}catch(o){n.e(o)}finally{n.f()}},getUserListRequest:function(){var e=this;Object(r["t"])().then((function(t){0===t.code?e.userList=t.data:1e3===t.code&&e.$message({type:"errow",message:"查询失败"})}))},findInfo:function(e){var t=this;this.itemInfo=e,this.itemInfo.checkHouseDetailList=[],this.infoDialogvisible=!0,Object(s["c"])({checkHouseId:e.id}).then((function(e){0===e.code&&(t.itemInfo.checkHouseDetailList=e.data)}))},handleClick:function(e,t){console.log(e,t)},tableRowClassName:function(e){e.row;var t=e.rowIndex;return t%2===1?"table-row":""},fetchDate:function(){var e=this;this.list=[],this.loading=!0;var t=null;this.searchKey.startTime&&(t=Object(c["b"])(this.searchKey.startTime,"{y}-{m}-{d}"));var n={houseNo:this.searchKey.name+""?this.searchKey.name:null,checkResult:this.searchKey.status+""?this.searchKey.status:null,checkTime:t,pageNum:this.pageIndex,pageSize:this.pageSize};Object(s["d"])(n).then((function(t){e.loading=!1,0===t.code&&(e.list=t.data.list,e.total=t.data.total)})),console.log(this.list)},searchBtn:function(){this.fetchDate()},searchrestBtn:function(){this.searchKey={name:"",startTime:"",endTime:"",status:""},this.pageIndex=1,this.pageSize=10,this.fetchDate()},handleCurrentChange:function(){this.fetchDate()},addBtn:function(){var e=this;this.dialogTitle="新建临时盘点任务",this.forms={startTime:"",person:""},this.columnsList=[],this.dialogVisible=!0,Object(s["e"])().then((function(t){e.setTreeByPid(t.data),console.log(t.data),e.fromData=t.data,e.toData=[],e.setList=[]}))},setTreeByPid:function(e){var t=this;e.forEach((function(e,n){e.pid="p"+e.pid,e.children?(e.id="p"+e.id,t.setTreeByPid(e.children)):e.id="c"+e.id}))},resetFrom:function(e){this.$refs[e].resetFields()},setBtn:function(e,t){var n=this;this.$confirm("确定关闭吗?","操作提示",{confirmButtonText:"确认",cancelButtonText:"取消"}).then((function(){var t={id:e.id};Object(s["a"])(t).then((function(e){n.loading=!1,0===e.code?(n.$message({message:"操作成功!",type:"success"}),n.fetchDate()):1e3===e.code&&n.$message({message:e.msg,type:"error"})}))}))},submitForm:function(e){var t=this;console.log(this.toData),this.$refs[e].validate((function(n){if(n){if(0===t.setList.length)return void t.$message({message:"请选择需要盘点的库位!",type:"error"});var i={checkHouseIds:t.setList.join(","),checkTime:Object(c["b"])(t.forms.startTime,"{y}-{m}-{d}"),checkUser:t.forms.person};Object(s["j"])(i).then((function(n){t.loading=!1,0===n.code?(t.$message({message:"操作成功!",type:"success"}),t.dialogVisible=!1,t.fetchDate(),t.$refs[e].resetFields()):1e3===n.code&&t.$message({message:n.msg,type:"error"})}))}}))}}},p=m,h=(n("a82a"),n("2877")),g=Object(h["a"])(p,i,o,!1,null,"6e0086db",null);t["default"]=g.exports}}]);