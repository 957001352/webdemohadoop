(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e14311e"],{"09f4":function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),Math.easeInOutQuad=function(t,e,a,n){return t/=n/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function s(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function i(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(t,e,a){var o=i(),r=t-o,l=20,c=0;e="undefined"===typeof e?500:e;var d=function t(){c+=l;var i=Math.easeInOutQuad(c,o,r,e);s(i),c<e?n(t):a&&"function"===typeof a&&a()};d()}},"2ac3":function(t,e,a){"use strict";a.d(e,"e",(function(){return s})),a.d(e,"g",(function(){return i})),a.d(e,"d",(function(){return o})),a.d(e,"f",(function(){return r})),a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return c})),a.d(e,"b",(function(){return d}));var n=a("b775");function s(t){return Object(n["a"])({url:window.configs.api+"/mouldStorageHouse/findStorageList",method:"get",params:t})}function i(t){return Object(n["a"])({url:window.configs.api+"/mouldStorageHouse/saveStorage",method:"post",data:t})}function o(t){return Object(n["a"])({url:window.configs.api+"/mouldStorageHouse/findLocationList",method:"get",params:t})}function r(t){return Object(n["a"])({url:window.configs.api+"/mouldStorageHouse/saveLocation",method:"post",data:t})}function l(t){return Object(n["a"])({url:window.configs.api+"/mouldStorageHouse/deleteLocation",method:"get",params:{ids:t}})}function c(t){return Object(n["a"])({url:window.configs.api+"/mouldStorageHouse/findEmptyLocationList",method:"get",params:t})}function d(t){return Object(n["a"])({url:window.configs.api+"/logisticsProduct/getAllCode",method:"get",params:t})}},"69c2":function(t,e,a){},"6ace":function(t,e,a){"use strict";a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return o}));var n=a("b775");function s(t){return Object(n["a"])({url:window.configs.api+"/attachment/upload",method:"post",data:t,heards:{"Content-Type":"multipart/form-data"}})}function i(t){return Object(n["a"])({url:window.configs.e2cUrl+"/productDevices/findList",method:"get",params:t})}function o(){return Object(n["a"])({url:window.configs.e2cUrl+"/devicesClassify/findList",method:"get"})}},a888:function(t,e,a){"use strict";a("99af"),a("caad"),a("ac1f"),a("2532"),a("5319");var n={bind:function(t,e,a){var n=t.querySelector(".el-dialog__header"),s=t.querySelector(".el-dialog");n.style.cssText+=";cursor:move;",s.style.cssText+=";top:0px;";var i=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();n.onmousedown=function(t){var e=t.clientX-n.offsetLeft,o=t.clientY-n.offsetTop,r=s.offsetWidth,l=s.offsetHeight,c=document.body.clientWidth,d=document.body.clientHeight,u=s.offsetLeft,p=c-s.offsetLeft-r,f=s.offsetTop,m=d-s.offsetTop-l,h=i(s,"left"),g=i(s,"top");h.includes("%")?(h=+document.body.clientWidth*(+h.replace(/\%/g,"")/100),g=+document.body.clientHeight*(+g.replace(/\%/g,"")/100)):(h=+h.replace(/\px/g,""),g=+g.replace(/\px/g,"")),document.onmousemove=function(t){var n=t.clientX-e,i=t.clientY-o;-n>u?n=-u:n>p&&(n=p),-i>f?i=-f:i>m&&(i=m),s.style.cssText+=";left:".concat(n+h,"px;top:").concat(i+g,"px;"),a.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}},s=function(t){t.directive("el-drag-dialog",n)};window.Vue&&(window["el-drag-dialog"]=n,Vue.use(s)),n.install=s;e["a"]=n},b50b:function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"e",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"d",(function(){return r})),a.d(e,"a",(function(){return l}));var n=a("b775");function s(t){return Object(n["a"])({url:window.configs.api+"/qualityInspection/findList",method:"get",params:t})}function i(t){return Object(n["a"])({url:window.configs.api+"/qualityInspection/save",method:"post",data:t})}function o(t){return Object(n["a"])({url:window.configs.api+"/qualityInspection/getInspectionDetail",method:"get",params:t})}function r(t){return Object(n["a"])({url:window.configs.api+"/qualityInspection/change",method:"post",data:t})}function l(t){return Object(n["a"])({url:window.configs.api+"/qualityInspection/getInspectionChangeLog",method:"get",params:t})}},c730:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"searchInfo"},[a("span",{staticClass:"seachname"},[t._v("零件代码:")]),a("el-input",{staticClass:"inputCls",staticStyle:{width:"240px","margin-right":"15px"},attrs:{placeholder:"请输入零件代码",clearable:""},model:{value:t.searchKey.code,callback:function(e){t.$set(t.searchKey,"code",e)},expression:"searchKey.code"}}),a("span",{staticClass:"seachname"},[t._v("零件名称:")]),a("el-input",{staticClass:"inputCls",staticStyle:{width:"240px","margin-right":"15px"},attrs:{placeholder:"请输入零件名称",clearable:""},model:{value:t.searchKey.name,callback:function(e){t.$set(t.searchKey,"name",e)},expression:"searchKey.name"}}),a("el-button",{staticClass:"primaryBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"primary"},on:{click:t.searchBtn}},[a("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" 查询 ")],1),a("el-button",{staticClass:"resetBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"default",icon:"el-icon-refresh-right"},on:{click:t.searchrestBtn}},[t._v("重置")])],1),a("div",{staticClass:"searchInfo"},[t.hasPermission("outhousingStandard/add")?a("el-button",{staticClass:"addBtn",attrs:{type:"default",icon:"el-icon-plus"},on:{click:t.addBtn}},[t._v("新建检验规范")]):t._e()],1),a("div",{staticClass:"el-tablenew"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,"row-class-name":t.tableRowClassName,border:"","header-cell-style":t.headerClassName,height:"calc(100vh - 337px)"}},[a("el-table-column",{attrs:{prop:"date",label:"序号",align:"center",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{prop:"code",label:"零件代码",align:"center",width:"150"}}),a("el-table-column",{attrs:{prop:"productName",label:"零件名称",align:"center","min-width":"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"drawing",label:"图纸编号",align:"center",width:"150"}}),a("el-table-column",{attrs:{prop:"changeTime",label:"最近变更时间",align:"center",width:"160"}}),a("el-table-column",{attrs:{prop:"reason",label:"变更原因",align:"center","min-width":"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"defaultTextBtn",attrs:{type:"text"},on:{click:function(a){return t.findInfo(e.row)}}},[a("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" 查看 ")],1),t.hasPermission("outhousingStandard/change")?a("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(a){return t.editBtn(e.row)}}},[a("svg-icon",{attrs:{"icon-class":"edit"}}),t._v(" 变更 ")],1):t._e()]}}])})],1),a("pagination",{staticClass:"pagePadd",attrs:{total:t.total,page:t.pageIndex,limit:t.pageSize},on:{"update:page":function(e){t.pageIndex=e},"update:limit":function(e){t.pageSize=e},pagination:t.handleCurrentChange}})],1),t.dialogVisible?a("div",{staticClass:"repairsty"},[a("outhousing-standard-info",{attrs:{objstr:t.objstr,type:t.type},on:{DetailCallBack:t.DetailCallBack}})],1):t._e()])},s=[],i=(a("c975"),a("b0c0"),a("b50b")),o=a("333d"),r=a("a888"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-page-header",{attrs:{content:"出库检验规范"},on:{back:function(e){return t.backClick(null)}}}),a("div",{staticClass:"content1"},[t._m(0),a("div",{staticClass:"contentBody"},[a("el-form",{ref:"forms",attrs:{model:t.forms,rules:t.rules,"label-position":"left","label-width":"90px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"零件编号:",prop:"productId"}},[a("el-select",{staticStyle:{width:"90%"},attrs:{disabled:"add"!==t.type,placeholder:"请选择零件编号"},on:{change:t.handleMateriel},model:{value:t.forms.productId,callback:function(e){t.$set(t.forms,"productId",e)},expression:"forms.productId"}},t._l(t.materielList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.code,value:t.id}})})),1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"零件名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{readonly:"",disabled:"add"!==t.type,placeholder:"零件名称",maxlength:"20"},model:{value:t.forms.name,callback:function(e){t.$set(t.forms,"name",e)},expression:"forms.name"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"图纸编号:",prop:"drawing"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{disabled:"add"!==t.type,placeholder:"图纸编号",maxlength:"20"},model:{value:t.forms.drawing,callback:function(e){t.$set(t.forms,"drawing",e)},expression:"forms.drawing"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"客户:",prop:"customer"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{disabled:"add"!==t.type,placeholder:"客户",maxlength:"20"},model:{value:t.forms.customer,callback:function(e){t.$set(t.forms,"customer",e)},expression:"forms.customer"}})],1)],1)],1)],1)],1)]),a("div",{staticClass:"content1"},[t._m(1),a("div",{staticClass:"contentBody el-tablenew"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,"row-class-name":t.tableRowClassName,"span-method":t.objectSpanMethod,border:""}},[a("el-table-column",{attrs:{label:"检验项目",align:"center"}},[a("el-table-column",{attrs:{label:"产品特性",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(0===e.row.classify?"外观":1===e.row.classify?"包装":2===e.row.classify?"材质":3===e.row.classify?"尺寸":4===e.row.classify?"备注":"巡检时间")+" ")]}}])}),a("el-table-column",{attrs:{label:"工艺（过程）特性",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[4!==e.row.classify?a("el-input",{attrs:{disabled:"find"===t.type,type:"textarea",autosize:"",placeholder:"内容",maxlength:"100"},model:{value:e.row.process,callback:function(a){t.$set(e.row,"process",a)},expression:"scope.row.process"}}):t._e(),4===e.row.classify?a("el-input",{attrs:{disabled:"find"===t.type,type:"textarea",autosize:"",placeholder:"内容",maxlength:"100"},model:{value:e.row.remark,callback:function(a){t.$set(e.row,"remark",a)},expression:"scope.row.remark"}}):t._e()]}}])})],1),a("el-table-column",{attrs:{prop:"name",label:"特殊特性分类",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[4!==e.row.classify?a("el-input",{attrs:{disabled:"find"===t.type,type:"textarea",autosize:"",placeholder:"内容",maxlength:"100"},model:{value:e.row.special,callback:function(a){t.$set(e.row,"special",a)},expression:"scope.row.special"}}):t._e()]}}])}),a("el-table-column",{attrs:{prop:"name",label:"产品/过程规范/公差",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[3!==e.row.classify&&4!==e.row.classify?a("el-input",{attrs:{disabled:"find"===t.type,type:"textarea",autosize:"",maxlength:"100",placeholder:"内容"},model:{value:e.row.standard,callback:function(a){t.$set(e.row,"standard",a)},expression:"scope.row.standard"}}):t._e(),3===e.row.classify?a("el-row",{staticStyle:{padding:"0"}},[a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,controls:!1,disabled:"find"===t.type,placeholder:"下限"},on:{blur:function(a){return t.handleChangeMin(e.$index)}},model:{value:e.row.standardmin,callback:function(a){t.$set(e.row,"standardmin",a)},expression:"scope.row.standardmin"}})],1),a("el-col",{attrs:{span:2}},[a("span",{staticStyle:{"line-height":"40px"}},[t._v(" ~ ")])]),a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,controls:!1,disabled:"find"===t.type,placeholder:"上限"},on:{blur:function(a){return t.handleChangeMax(e.$index)}},model:{value:e.row.standardmax,callback:function(a){t.$set(e.row,"standardmax",a)},expression:"scope.row.standardmax"}})],1)],1):t._e()]}}])}),a("el-table-column",{attrs:{prop:"devicesName",label:"评价/测量技术",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[4!==e.row.classify?a("el-input",{attrs:{disabled:"find"===t.type,type:"textarea",autosize:"",placeholder:"内容",maxlength:"100"},model:{value:e.row.evaluate,callback:function(a){t.$set(e.row,"evaluate",a)},expression:"scope.row.evaluate"}}):t._e()]}}])}),a("el-table-column",{attrs:{label:"检验频率/控制方法",align:"center"}},[a("el-table-column",{attrs:{label:"大小",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[4!==e.row.classify?a("el-input",{staticStyle:{width:"95%"},attrs:{controls:!1,disabled:"find"===t.type,type:"textarea",autosize:"",placeholder:"内容",maxlength:"100"},model:{value:e.row.measure,callback:function(a){t.$set(e.row,"measure",a)},expression:"scope.row.measure"}}):t._e()]}}])}),a("el-table-column",{attrs:{label:"频度",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[4!==e.row.classify?a("el-input",{attrs:{disabled:"find"===t.type,placeholder:"内容",type:"textarea",autosize:"",maxlength:"100"},model:{value:e.row.quota,callback:function(a){t.$set(e.row,"quota",a)},expression:"scope.row.quota"}}):t._e()]}}])})],1),a("el-table-column",{attrs:{prop:"devicesName",label:"附件",align:"center",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return["find"!==t.type&&4!==e.row.classify?a("el-upload",{staticClass:"styeFile",attrs:{action:"","before-upload":t.beforeFile,"http-request":t.uploadImage,"show-file-list":!1}},[a("el-button",{staticClass:"primaryBtn",attrs:{size:"small",type:"primary"},on:{click:function(a){return t.getfile(e.$index)}}},[t._v("点击上传")])],1):t._e(),4!==e.row.classify&&null!=e.row.uploadFile.name&&0!=e.row.uploadFile.name.length?a("el-link",{on:{click:function(a){return t.handleDownFile(e.row.uploadFile.path)}}},[t._v(t._s(e.row.uploadFile.name)+"."+t._s(e.row.uploadFile.suffix))]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["find"!==t.type&&e.$index===e.row.start&&4!==e.row.classify?a("el-button",{staticClass:"addTextBtn",attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(a){return t.addBtn(e.row,e.$index)}}},[t._v("加项")]):t._e(),"find"!==t.type&&e.$index!==e.row.start&&4!==e.row.classify?a("el-button",{staticClass:"deleteTextBtn",attrs:{type:"text",icon:"el-icon-minus"},on:{click:function(a){return t.deleteBtn(e.row,e.$index)}}},[t._v("减项")]):t._e()]}}])})],1)],1)]),"edit"===t.type?a("div",{staticClass:"content1"},[t._m(2),a("div",{staticClass:"contentBody",staticStyle:{overflow:"auto"}},[a("el-form",{ref:"upforms",attrs:{model:t.forms,rules:t.rules,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"变更原因:",prop:"upReason"}},[a("el-input",{staticStyle:{"max-width":"300px"},attrs:{placeholder:"变更原因",maxlength:"20"},model:{value:t.forms.upReason,callback:function(e){t.$set(t.forms,"upReason",e)},expression:"forms.upReason"}})],1),a("el-form-item",{attrs:{label:"变更内容:",prop:"dis"}},[a("el-input",{staticStyle:{"max-width":"300px"},attrs:{rows:5,resize:"none",type:"textarea",placeholder:"变更内容",maxlength:"50"},model:{value:t.forms.dis,callback:function(e){t.$set(t.forms,"dis",e)},expression:"forms.dis"}})],1)],1)],1)]):t._e(),"find"===t.type?a("div",{staticClass:"content1"},[t._m(3),a("div",{staticClass:"contentBody el-tablenew"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.logsList,"row-class-name":t.tableRowClassName,border:""}},[a("el-table-column",{attrs:{prop:"date",label:"序号",align:"center",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.$index+1)+" ")]}}],null,!1,3056706777)}),a("el-table-column",{attrs:{prop:"version",label:"版本",align:"center",width:"70"}}),a("el-table-column",{attrs:{prop:"createTime",label:"变更时间",align:"center",width:"160"}}),a("el-table-column",{attrs:{prop:"createUserName",label:"变更人员",align:"center",width:"90"}}),a("el-table-column",{attrs:{prop:"reason",label:"变更原因",align:"center","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"content",label:"变更内容",align:"center","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"auditStatus",label:"审核结果",align:"center",width:"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"defaultTextBtn",attrs:{type:"text"},on:{click:function(a){return t.findInfo(e.row)}}},[a("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" 查看 ")],1)]}}],null,!1,94581656)})],1)],1)]):t._e(),a("div",{staticClass:"bottom"},["find"!==t.type?a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("保存")]):t._e()],1)],1)},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 基本信息")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 检验内容")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 变更操作")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("span",{staticClass:"ganggang"},[t._v("-")]),t._v(" 变更记录")])}],d=(a("99af"),a("c740"),a("d81d"),a("a434"),a("d3b7"),a("ac1f"),a("25f0"),a("3ca3"),a("1276"),a("ddb0"),a("2909")),u=a("2ac3"),p=a("6ace"),f={name:"OuthousingStandardInfo",directives:{elDragDialog:r["a"]},props:{objstr:{type:Object,default:null},type:{type:String,default:"add"}},data:function(){return{loading:!1,baseUrl:window.configs.api,forms:{productId:"",name:"",customer:"",drawing:"",note:"",upReason:"",dis:""},rules:{productId:[{required:!0,message:"请选择零件编号",trigger:"blur"}],name:[{required:!0,message:"请输入零件名称",trigger:"blur"}],customer:[{required:!0,message:"请输入客户",trigger:"blur"}],drawing:[{required:!0,message:"请输入图纸编号",trigger:"blur"}],upReason:[{required:!0,message:"请输入变更原因",trigger:"blur"}],dis:[{required:!0,message:"请输入变更内容",trigger:"blur"}]},uploadIndex:-1,materielList:[],oMateriel:{},logsList:[],list:[{classify:0,feature:"",special:"",process:"",standard:"",standardmin:"",standardmax:"",evaluate:"",measure:"",quota:"",control:"",inspectionId:"",uploadFile:{dataId:"",name:"",webPath:"",suffix:""},start:0,end:0},{classify:1,feature:"",special:"",process:"",standard:"",standardmin:"",standardmax:"",evaluate:"",measure:"",quota:"",control:"",inspectionId:"",uploadFile:"",start:1,end:1},{classify:3,feature:"",special:"",process:"",standard:"",standardmin:"",standardmax:"",evaluate:"",measure:"",quota:"",control:"",inspectionId:"",uploadFile:"",start:2,end:2},{classify:4,remark:"",start:3,end:3}]}},computed:{},created:function(){},mounted:function(){"add"===this.type?this.getAllCodeRequest():this.initData()},methods:{headerClassName:function(t){t.row,t.rowIndex;return"background-color: #FAFAFA"},tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===1?"table-row":""},objectSpanMethod:function(t){var e=t.row,a=(t.column,t.rowIndex),n=t.columnIndex;return 0!==n&&7!==n||e.start===e.end?0!==n&&4===e.classify?1===n?[1,8]:[0,0]:void 0:e.start===a?{rowspan:e.end-e.start+1,colspan:1}:{rowspan:0,colspan:0}},backClick:function(t){this.$emit("DetailCallBack",{result:t})},getfile:function(t){this.uploadIndex=t},beforeFile:function(t){var e=t.size/1024/1024<5;if(!e)return this.$message.error("上传图片大小不能超过 5MB!"),!1},uploadImage:function(t){var e=this,a=new FormData;a.append("file",t.file),a.append("isAdd",!0),Object(p["c"])(a).then((function(t){0===t.code&&(e.list[e.uploadIndex].uploadFile=t.data,e.list[e.uploadIndex].id=t.data.dataId,e.$message({type:"success",message:"上传成功！"}))}))},handleChangeMin:function(t){this.list[t].standardmax&&parseFloat(this.list[t].standardmin+"")>=parseFloat(this.list[t].standardmax+"")&&(this.list[t].standardmin="",this.$message({type:"error",message:"尺寸下限必须小于上线！"}))},handleChangeMax:function(t){this.list[t].standardmin&&parseFloat(this.list[t].standardmin+"")>=parseFloat(this.list[t].standardmax+"")&&(this.list[t].standardmax=this.list[t].standardmin+1,this.$message({type:"error",message:"尺寸下限必须小于上线！"}))},deleteBtn:function(t,e){this.list.splice(e,1),this.setMerge()},addBtn:function(t,e){var a={classify:t.classify,feature:"1",special:"",process:"",standard:"",standardmin:"",standardmax:"",evaluate:"",measure:"",quota:"",control:"",inspectionId:t.inspectionId,uploadFile:"",start:3,end:3};this.list.splice(e+(t.end-t.start)+1,0,a),this.setMerge()},setMerge:function(){for(var t=0,e=0,a=-1,n=0;n<this.list.length;n++){if(a!==this.list[n].classify){a=this.list[n].classify,t=n,e=n;for(var s=n;s<this.list.length;s++)if(a!==this.list[s].classify){e=s-1;break}}this.list[n].start=parseInt(t+""),this.list[n].end=parseInt(e+"")}},findInfo:function(t){this.getchangeLogDetailRequest(t.id)},submitForm:function(){"add"===this.type?this.saveRequest():"edit"===this.type&&this.saveChangeRequest()},saveRequest:function(){var t=this,e=[];this.list.map((function(a){if(1*a.classify===4)t.forms.note=a.remark;else{var n=a.standard;1*a.classify===3&&(n=a.standardmin+"-"+a.standardmax),e.push({id:a.uploadFile.dataId,classify:a.classify,process:a.process,special:a.special,standard:n,evaluate:a.evaluate,measure:a.measure,quota:a.quota})}}));var a={classify:3,customer:this.forms.customer,drawing:this.forms.drawing,note:this.forms.note,productId:this.forms.productId,qualityInspectionDetails:e},n=this.formValidate(a);n&&Object(i["e"])(a).then((function(e){0===e.code?(t.$message({type:"success",message:"添加成功！"}),t.$emit("DetailCallBack",{result:1})):1e3===e.code&&t.$message({type:"error",message:"添加失败："+e.msg})}))},saveChangeRequest:function(){var t=this,e="add"===this.type?"forms":"upforms";this.$refs[e].validate((function(e){if(e){var a=[];t.list.map((function(e){if(4===e.classify)t.forms.note=e.remark;else{var n=e.standard;3===e.classify&&(n=e.standardmin+"-"+e.standardmax),a.push({id:e.uploadFile.dataId,classify:e.classify,process:e.process,special:e.special,standard:n,evaluate:e.evaluate,measure:e.measure,inspectionId:e.inspectionId,quota:e.quota,webPath:e.uploadFile.webPath,name:e.uploadFile.name,suffix:e.uploadFile.suffix})}}));var n=[].concat(a);n.push({classify:4,remark:t.forms.note,start:0,end:0});var s={content:t.forms.dis,reason:t.forms.upReason,inspectionContent:JSON.stringify(n)},o={id:t.forms.id,classify:3,customer:t.forms.customer,drawing:t.forms.drawing,productId:t.forms.productId,qualityInspectionDetails:a,qualityInspectionChangeLog:s},r=t.formValidate(o);if(!r)return;Object(i["d"])(o).then((function(e){0===e.code?(t.$message({type:"success",message:"保存变更成功！"}),t.$emit("DetailCallBack",{result:1})):1e3===e.code&&t.$message({type:"error",message:"保存变更失败："+e.msg})}))}}))},handleMateriel:function(t){var e=this.materielList.findIndex((function(e){return e.id===t}));-1!==e?(this.oMateriel=this.materielList[e],this.forms.productId=t,this.forms.name=this.oMateriel.name):(this.oMateriel={},this.forms.productId="",this.forms.name="")},handleDownFile:function(t){var e=this.baseUrl+"/attachment/downByPath?path="+t,a=window.open(encodeURI(e));setTimeout((function(){a.close()}),1e3)},getAllCodeRequest:function(){var t=this;Object(u["b"])().then((function(e){0===e.code?e.data.length>0?t.materielList=e.data:t.$message({type:"error",message:"没有零件信息!"}):t.$message({type:"error",message:"获取零件信息失败："+e.msg})}))},getchangeLogDetailRequest:function(t){var e=this,a={id:t};Object(i["a"])(a).then((function(t){if(0===t.code){var a=JSON.parse(t.data.inspectionContent),n=e.optTestContentData(a);e.list=Object(d["a"])(n),e.setMerge()}else e.$message({type:"error",message:"获取检验规范信息失败："+t.msg})}))},showData:function(t){this.forms={id:t.id,productId:t.productId,name:t.productName,customer:t.customer,drawing:t.drawing,note:t.note,upReason:null,dis:null},this.handleMateriel(t.productId);var e=t.qualityInspectionDetails;e.sort((function(t,e){return t.classify-e.classify}));var a=Object(d["a"])(e);a.push({classify:4,remark:t.note,start:0,end:0});var n=this.optTestContentData(a);this.list=Object(d["a"])(n),this.setMerge(),this.logsList=t.qualityInspectionChangeLogs},sortBy:function(t,e){return e=void 0===e||e?1:-1,function(a,n){return a=a[t],n=n[t],a<n?-1*e:a>n?1*e:0}},optTestContentData:function(t){var e=[];t.map((function(t){var a=0,n=0,s={};if(1*t.classify===3){var i=t.standard.split("-");a=i[0],n=i[1]}s=1*t.classify===4?{classify:4,remark:t.remark,start:0,end:0}:{id:t.id,classify:t.classify,feature:t.feature,special:t.special,process:t.process,standard:t.standard,standardmin:a,standardmax:n,evaluate:t.evaluate,measure:t.measure,quota:t.quota,control:t.control,inspectionId:t.inspectionId,uploadFile:{dataId:t.id,name:t.name,webPath:t.webPath,path:t.path,suffix:t.suffix},start:0,end:0},e.push(s)}));var a=e.sort(this.sortBy("classify",!0));return a},initData:function(){var t=this,e=new Promise((function(t,e){Object(u["b"])().then((function(e){t(e)})).catch((function(t){e(t)}))})),a=new Promise((function(e,a){var n={id:t.objstr.id};Object(i["c"])(n).then((function(t){e(t)})).catch((function(t){a(t)}))}));Promise.all([e,a]).then((function(e){var a=e;0===a[0].code?a[0].data.length>0?t.materielList=a[0].data:t.$message({type:"error",message:"没有零件信息!"}):t.$message({type:"error",message:"获取零件信息失败："+a[0].msg}),0===a[1].code?t.showData(a[1].data):t.$message({type:"error",message:"获取检验规范信息失败："+a[1].msg})}))},formValidate:function(t){for(var e=!0,a=t.qualityInspectionDetails,n=!0,s=0;s<a.length;s++){if(0===a[s].standard.toString().length||0===a[s].evaluate.toString().length||0===a[s].measure.toString().length||0===a[s].quota.toString().length){n=!1;break}if(3===a[s].classify&&(1*a[s].standardMax===0||1*a[s].standardMin===0)){n=!1;break}}return 0===t.productId.toString().length?(this.$message({type:"warning",message:"零件编号不能为空!"}),e=!1):0===t.drawing.toString().length?(this.$message({type:"warning",message:"图纸编号不能为空!"}),e=!1):0===t.customer.length?(this.$message({type:"warning",message:"客户不能为空!"}),e=!1):n?e=!0:(this.$message({type:"warning",message:"请完善检验内容表格相关信息!"}),e=!1),e}}},m=f,h=(a("e1a0"),a("2877")),g=Object(h["a"])(m,l,c,!1,null,"6a00fca6",null),b=g.exports,w={name:"OuthousingStandard",directives:{elDragDialog:r["a"]},components:{Pagination:o["a"],"outhousing-standard-info":b},data:function(){return{loading:!1,dialogVisible:!1,disabled:!1,dialogTitle:"",searchKey:{name:"",code:""},type:"add",total:0,objstr:null,pageIndex:1,pageSize:10,currentId:0,list:[]}},computed:{},mounted:function(){var t=this;this.fetchDate(),this.computedTableHeight(),window.onresize=function(){return function(){t.computedTableHeight()}()}},methods:{headerClassName:function(t){t.row,t.rowIndex;return"background-color: #FAFAFA"},tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===1?"table-row":""},fetchDate:function(){var t=this;this.list=[],this.multipleSelection=[],this.loading=!0;var e={productName:this.searchKey.name+""?this.searchKey.name:null,code:this.searchKey.code+""?this.searchKey.code:null,classify:3,pageNum:this.pageIndex,pageSize:this.pageSize};Object(i["b"])(e).then((function(e){t.loading=!1,0===e.code&&(t.list=e.data.list,t.total=e.data.total)}))},searchBtn:function(){this.fetchDate()},searchrestBtn:function(){this.searchKey={name:"",type:""},this.pageIndex=1,this.pageSize=10,this.fetchDate()},handleCurrentChange:function(){this.fetchDate()},DetailCallBack:function(t){this.dialogVisible=!1,1===t.result&&this.fetchDate()},findInfo:function(t){this.type="find",this.dialogVisible=!0,this.objstr=t},addBtn:function(){this.type="add",this.dialogVisible=!0},editBtn:function(t){!t.auditStatus||t.auditStatus.indexOf("待")<0?(this.dialogVisible=!0,this.type="edit",this.objstr=t):this.$message({message:"变更申请正在审核中...",type:"warning"})},computedTableHeight:function(){var t=document.body.clientHeight;t=t<768?768:t,this.tableHeight=t-315}}},y=w,v=(a("fbc0"),Object(h["a"])(y,n,s,!1,null,"7d1d478c",null));e["default"]=v.exports},e1a0:function(t,e,a){"use strict";var n=a("69c2"),s=a.n(n);s.a},fbc0:function(t,e,a){"use strict";var n=a("ff38"),s=a.n(n);s.a},ff38:function(t,e,a){}}]);