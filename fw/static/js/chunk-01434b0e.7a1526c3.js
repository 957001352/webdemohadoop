(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01434b0e"],{"074f":function(e,t,i){},"09f4":function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),Math.easeInOutQuad=function(e,t,i,n){return e/=n/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function a(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,i){var r=a(),s=e-r,l=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=l;var a=Math.easeInOutQuad(c,r,s,t);o(a),c<t?n(e):i&&"function"===typeof i&&i()};u()}},2423:function(e,t,i){"use strict";i.d(t,"p",(function(){return o})),i.d(t,"h",(function(){return a})),i.d(t,"l",(function(){return r})),i.d(t,"c",(function(){return s})),i.d(t,"t",(function(){return l})),i.d(t,"k",(function(){return c})),i.d(t,"u",(function(){return u})),i.d(t,"j",(function(){return d})),i.d(t,"o",(function(){return m})),i.d(t,"g",(function(){return f})),i.d(t,"n",(function(){return p})),i.d(t,"f",(function(){return g})),i.d(t,"q",(function(){return h})),i.d(t,"b",(function(){return b})),i.d(t,"e",(function(){return v})),i.d(t,"r",(function(){return w})),i.d(t,"a",(function(){return y})),i.d(t,"d",(function(){return F})),i.d(t,"m",(function(){return k})),i.d(t,"i",(function(){return D})),i.d(t,"s",(function(){return S})),i.d(t,"v",(function(){return j}));var n=i("b775");function o(e){return Object(n["a"])({url:window.configs.api+"/jbpmDeployment/findList",method:"get",params:e})}function a(e){return Object(n["a"])({url:window.configs.api+"/jbpmDeployment/save",method:"post",data:e})}function r(){return Object(n["a"])({url:window.configs.api+"/jbpmDeployment/findJbpmFormList",method:"get"})}function s(e){return Object(n["a"])({url:window.configs.api+"/jbpmDeployment/delete",method:"get",params:{ids:e}})}function l(){return Object(n["a"])({url:window.configs.e2cUrl+"/user/findList",method:"get"})}function c(e){return Object(n["a"])({url:window.configs.api+"/jbpmExecution/findWaitTaskList",method:"get",params:e})}function u(e){return Object(n["a"])({url:window.configs.api+"/jbpmExecution/findHistTaskList",method:"get",params:e})}function d(e,t){return Object(n["a"])({url:window.configs.api+"/devicesRepai/findList",method:"get",params:{id:e}})}function m(e){return Object(n["a"])({url:window.configs.api+"/jbpmExecution/findHistTaskDeatilList",method:"get",params:e})}function f(e){return Object(n["a"])({url:window.configs.api+"/jbpmExecution/doTask",method:"post",data:e})}function p(e){return Object(n["a"])({url:window.configs.api+"/devicesKeepTask/getDevicesKeepTask",method:"get",params:{id:e}})}function g(e){return Object(n["a"])({url:window.configs.api+"/devicesScrap/findList",method:"get",params:{devicesScrapId:e}})}function h(e){return Object(n["a"])({url:window.configs.api+"/devicesCheckTeam/findList",method:"get",params:e})}function b(e){return Object(n["a"])({url:window.configs.api+"/devicesCheckTeam/save",method:"post",data:e})}function v(e){return Object(n["a"])({url:window.configs.api+"/devicesCheckTeam/delete",method:"get",params:{ids:e}})}function w(e){return Object(n["a"])({url:window.configs.api+"/devicesCheckItem/findList",method:"get",params:e})}function y(e){return Object(n["a"])({url:window.configs.api+"/devicesCheckItem/save",method:"post",data:e})}function F(e){return Object(n["a"])({url:window.configs.api+"/devicesCheckItem/delete",method:"get",params:{ids:e}})}function k(){return Object(n["a"])({url:window.configs.e2cUrl+"/devicesClassify/findList",method:"get"})}function D(e){return Object(n["a"])({url:window.configs.e2cUrl+"/productDevices/findList",method:"get",param:e})}function S(e){return Object(n["a"])({url:window.configs.api+"/devicesCheck/findList",method:"get",params:e})}function j(e){return Object(n["a"])({url:window.configs.api+"/mouldDevices/findOneById",method:"get",params:{id:e}})}},"46ff":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-table",{key:e.tableKey,staticStyle:{width:"100%"},attrs:{stripe:"",data:e.tableList,border:"",fit:"","highlight-current-row":"",height:"635px","header-cell-style":e.headerClassName},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),i("el-table-column",{attrs:{prop:"name",label:"流程名称",align:"center"}}),i("el-table-column",{attrs:{prop:"formName",label:"审核对象",align:"center"}}),i("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasPermission("flowSetting/find")?i("el-button",{staticClass:"defaultTextBtn",attrs:{type:"text"},on:{click:function(i){return e.flowDialog("lookover",t.row)}}},[i("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" 查看 ")],1):e._e(),e.hasPermission("flowSetting/edit")?i("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(i){return e.flowDialog("edit",t.row)}}},[i("svg-icon",{attrs:{"icon-class":"edit"}}),e._v(" 编辑 ")],1):e._e()]}}])})],1),i("pagination",{attrs:{total:e.total,page:e.listQuery.pageNum,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"pageNum",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.getList}}),e.dialogFormVisible?i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"dialogs",attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"close-on-click-modal":!1,width:"480px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[e.dialogFormVisible?i("addFlowSetting",{attrs:{"device-data":e.deviceData},on:{DetailCallBack:e.DetailCallBack}}):e._e()],1):e._e()],1)},o=[],a=(i("4160"),i("d3b7"),i("159b"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container222"},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-position":"top"}},[i("el-form-item",{attrs:{label:"流程名称：",prop:"name"}},[i("el-input",{attrs:{readonly:e.readOnly},on:{input:function(t){e.ruleForm.name=e.inputRule(e.ruleForm.name)}},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),i("el-form-item",{attrs:{label:"审核对像：",prop:"formId"}},[i("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.ruleForm.formId,callback:function(t){e.$set(e.ruleForm,"formId",t)},expression:"ruleForm.formId"}},e._l(e.deviceObject,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),i("el-form-item",{attrs:{label:"编辑审核过程：",prop:"auditUsers"}},[i("el-timeline",{attrs:{reverse:e.reverse}},[e._l(e.flowStep,(function(t,n){return i("el-timeline-item",{key:n,staticClass:"asdasdas"},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("div",{staticClass:"el-icon-remove-outline",on:{click:function(t){return e.subtractFlowStep(n)}}}),"lookover"!=e.deviceData.dialogType?i("el-select",{attrs:{placeholder:"请选择",multiple:""},model:{value:e.flowStep[n].auditUsers,callback:function(t){e.$set(e.flowStep[n],"auditUsers",t)},expression:"flowStep[index].auditUsers "}},e._l(e.userList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id+""}})})),1):e._e(),"lookover"==e.deviceData.dialogType?i("el-input",{attrs:{readonly:""},model:{value:e.flowStep[n].auditUserNames,callback:function(t){e.$set(e.flowStep[n],"auditUserNames",t)},expression:"flowStep[index].auditUserNames"}}):e._e()],1)])})),"lookover"!==e.deviceData.dialogType?i("el-timeline-item",[i("div",{staticClass:"el-icon-circle-plus-outline",on:{click:e.addFlowStep}})]):e._e()],2)],1)],1),"lookover"!==e.deviceData.dialogType?i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"resetBtn",on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]),i("el-button",{staticClass:"sumbitBtn",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")])],1):e._e()],1)}),r=[],s=(i("a434"),i("b0c0"),i("ac1f"),i("25f0"),i("1276"),i("5530")),l=i("2423"),c={components:{},props:{deviceData:{type:Object,required:!0}},data:function(){return{labelPosition:"left",deviceObject:[],userList:[],ruleForm:{name:"",type:["页面通知","发送邮件"],emailNotice:0,formId:null,messNotice:0,noteList:[],id:null},reverse:!1,flowStep:[{auditUsers:[]}],readOnly:!1,auditUsers:[],disabled:!1,auditUsersIsTrue:null,rules:{name:[{required:!0,message:"请输入",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],type:[{type:"array",required:!0,message:"请选择至少一项",trigger:"change"}],auditUsers:[{message:"审核流程不能为空",trigger:"blur"}],formId:[{required:!0,message:"请选择",trigger:"change"}]}}},computed:{},watch:{},created:function(){},mounted:function(){Object(s["a"])({},this.deviceData.detailInfo);"lookover"===this.deviceData.dialogType?(this.readOnly=!0,this.giveData()):"edit"===this.deviceData.dialogType?(this.readOnly=!1,this.giveData()):this.readOnly=!1,this.getUserListRequest(),this.getDeviceListRequest(),this.handleCheckBox()},beforeDestroy:function(){},methods:{giveData:function(){var e=this;this.deviceData.detailInfo.noteList.forEach((function(t,i){"string"===typeof t.auditUsers?e.deviceData.detailInfo.noteList[i].auditUsers=t.auditUsers.split(","):e.deviceData.detailInfo.noteList[i].auditUsers=t.auditUsers})),this.ruleForm.type=[],this.ruleForm.name=this.deviceData.detailInfo.name,this.ruleForm.formId=this.deviceData.detailInfo.formId,this.ruleForm.noteList=this.deviceData.detailInfo.noteList,this.ruleForm.id=this.deviceData.detailInfo.id,this.ruleForm.messNotice=this.deviceData.detailInfo.messNotice,this.ruleForm.emailNotice=this.deviceData.detailInfo.emailNotice,this.flowStep=this.ruleForm.noteList,1===this.ruleForm.messNotice&&this.ruleForm.type.push("页面通知"),1===this.ruleForm.emailNotice&&this.ruleForm.type.push("发送邮件")},handleCheckBox:function(e){var t=this;console.log(e),void 0===e&&(e=this.ruleForm.type),this.ruleForm.emailNotice="0",this.ruleForm.messNotice="0",e.forEach((function(e){"页面通知"===e?t.ruleForm.messNotice="1":"发送邮件"===e&&(t.ruleForm.emailNotice="1")})),console.log(this.ruleForm.emailNotice,this.ruleForm.messNotice)},addFlowStep:function(){"lookover"!==this.deviceData.dialogType&&this.flowStep.push({auditUsers:""})},subtractFlowStep:function(e){this.flowStep.length>1&&"lookover"!==this.deviceData.dialogType&&this.flowStep.splice(e,1)},submitForm:function(e){var t=this;console.log(this.flowStep),0!==this.flowStep[0].auditUsers.length?this.$refs[e].validate((function(e){if(!e)return!1;var i=t.ruleForm,n=[];n=t.flowStep,t.flowStep.forEach((function(e,i){0===e.auditUsers.length&&t.flowStep.splice(i,1),n[i].auditUsers=e.auditUsers.toString()})),delete i.type,i.noteList=n,t.submitRequest(i)})):this.$message({type:"warning",message:"请填写审核流程"})},resetForm:function(e){this.$refs[e].resetFields(),this.flowStep=[{auditUsers:[]}],this.ruleForm.type=["页面通知","发送邮件"]},submitRequest:function(e){var t=this;Object(l["h"])(e).then((function(e){0===e.code?(t.$message({type:"success",message:"操作成功"}),t.$emit("DetailCallBack",!0)):(t.$message({type:"errow",message:"操作失败"}),t.$emit("DetailCallBack",!1))}))},getDeviceListRequest:function(){var e=this;Object(l["l"])().then((function(t){0===t.code?e.deviceObject=t.data:e.$message({type:"errow",message:"查询失败"})}))},getUserListRequest:function(){var e=this;Object(l["t"])().then((function(t){0===t.code?e.userList=t.data:e.$message({type:"errow",message:"查询失败"})}))}}},u=c,d=(i("d691"),i("2877")),m=Object(d["a"])(u,a,r,!1,null,"c1b56b86",null),f=m.exports,p=i("a888"),g=i("333d"),h={name:"AddFlowSetting",components:{addFlowSetting:f,Pagination:g["a"]},directives:{elDragDialog:p["a"]},filters:{},data:function(){return{deviceData:{dialogType:"",detailInfo:""},tableKey:0,multipleSelection:[],dialogFormVisible:!1,rules:{type:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}],title:[{required:!0,message:"title is required",trigger:"blur"}]},dialogTitle:"审核流程",tableList:[],ids:"",total:0,listQuery:{pageNum:1,pageSize:20}}},created:function(){this.getList()},mounted:function(){},methods:{DetailCallBack:function(e){this.dialogFormVisible=!1,e&&this.getList()},getList:function(){var e=this;Object(l["p"])(this.listQuery).then((function(t){0===t.code&&(e.tableList=t.data.list,e.total=t.data.total)}))},flowDialog:function(e,t){console.log(t),this.deviceData.dialogType=e,"lookover"!==e&&"edit"!==e||(this.deviceData.detailInfo=t),this.dialogFormVisible=!0},handleSelectionChange:function(e){this.multipleSelection=e,this.ids="";var t=[];this.multipleSelection.forEach((function(e){t.push(e.id)})),this.ids=t.toString()},headerClassName:function(e){e.row,e.rowIndex;return"background-color: #FAFAFA"},handleDelte:function(){var e=this;0!==this.multipleSelection.length?this.$confirm("确定删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.handleDelete()})):this.$message({message:"您还没有选择数据!",type:"warning"})},handleDelete:function(){var e=this;Object(l["c"])(this.ids).then((function(t){0===t.code?(e.$message({message:"删除成功!",type:"success"}),e.getList()):e.$message({message:"删除失败!",type:"errow"})}))}}},b=h,v=(i("6262"),Object(d["a"])(b,n,o,!1,null,"636229bd",null));t["default"]=v.exports},6262:function(e,t,i){"use strict";var n=i("6f43"),o=i.n(n);o.a},"6f43":function(e,t,i){},a888:function(e,t,i){"use strict";i("99af"),i("caad"),i("ac1f"),i("2532"),i("5319");var n={bind:function(e,t,i){var n=e.querySelector(".el-dialog__header"),o=e.querySelector(".el-dialog");n.style.cssText+=";cursor:move;",o.style.cssText+=";top:0px;";var a=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}();n.onmousedown=function(e){var t=e.clientX-n.offsetLeft,r=e.clientY-n.offsetTop,s=o.offsetWidth,l=o.offsetHeight,c=document.body.clientWidth,u=document.body.clientHeight,d=o.offsetLeft,m=c-o.offsetLeft-s,f=o.offsetTop,p=u-o.offsetTop-l,g=a(o,"left"),h=a(o,"top");g.includes("%")?(g=+document.body.clientWidth*(+g.replace(/\%/g,"")/100),h=+document.body.clientHeight*(+h.replace(/\%/g,"")/100)):(g=+g.replace(/\px/g,""),h=+h.replace(/\px/g,"")),document.onmousemove=function(e){var n=e.clientX-t,a=e.clientY-r;-n>d?n=-d:n>m&&(n=m),-a>f?a=-f:a>p&&(a=p),o.style.cssText+=";left:".concat(n+g,"px;top:").concat(a+h,"px;"),i.child.$emit("dragDialog")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},o=function(e){e.directive("el-drag-dialog",n)};window.Vue&&(window["el-drag-dialog"]=n,Vue.use(o)),n.install=o;t["a"]=n},d691:function(e,t,i){"use strict";var n=i("074f"),o=i.n(n);o.a}}]);