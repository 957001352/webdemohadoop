(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77d09992"],{"09f4":function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),Math.easeInOutQuad=function(t,e,n,i){return t/=i/2,t<1?n/2*t*t+e:(t--,-n/2*(t*(t-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function o(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function a(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(t,e,n){var s=a(),r=t-s,c=20,l=0;e="undefined"===typeof e?500:e;var u=function t(){l+=c;var a=Math.easeInOutQuad(l,s,r,e);o(a),l<e?i(t):n&&"function"===typeof n&&n()};u()}},"2a9b":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"searchInfo"},[n("span",{staticClass:"seachname"},[t._v(" 生产指令: ")]),n("el-input",{staticClass:"inputCls",staticStyle:{width:"150px","margin-right":"15px"},attrs:{placeholder:"生产指令",clearable:""},model:{value:t.searchKey.code,callback:function(e){t.$set(t.searchKey,"code",e)},expression:"searchKey.code"}}),n("span",{staticClass:"seachname",staticStyle:{"margin-left":"15px"}},[t._v(" 零件号: ")]),n("el-input",{staticClass:"inputCls",staticStyle:{width:"140px","margin-right":"15px"},attrs:{placeholder:"零件号",clearable:""},model:{value:t.searchKey.name,callback:function(e){t.$set(t.searchKey,"name",e)},expression:"searchKey.name"}}),n("span",{staticClass:"seachname",staticStyle:{"margin-left":"15px"}},[t._v(" 状态: ")]),n("el-select",{staticClass:"inputCls",staticStyle:{width:"90px","margin-right":"15px"},attrs:{placeholder:"状态",clearable:""},model:{value:t.searchKey.status,callback:function(e){t.$set(t.searchKey,"status",e)},expression:"searchKey.status"}},t._l(t.statusList,(function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1),n("span",{staticClass:"seachname"},[t._v(" 生产开始日期: ")]),n("el-date-picker",{staticClass:"inputCls",staticStyle:{width:"140px","margin-right":"5px"},attrs:{editable:!1,"picker-options":t.startPickerOptions,type:"date",placeholder:"开始时间",clearable:""},model:{value:t.searchKey.startTime,callback:function(e){t.$set(t.searchKey,"startTime",e)},expression:"searchKey.startTime"}}),n("span",{staticClass:"seachname"},[t._v(" — ")]),n("el-date-picker",{staticClass:"inputCls",staticStyle:{width:"140px","margin-right":"15px"},attrs:{editable:!1,"picker-options":t.endPickerOptions,type:"date",placeholder:"结束时间",clearable:""},model:{value:t.searchKey.endTime,callback:function(e){t.$set(t.searchKey,"endTime",e)},expression:"searchKey.endTime"}}),n("el-button",{staticClass:"primaryBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"primary"},on:{click:t.searchBtn}},[n("svg-icon",{attrs:{"icon-class":"search"}}),t._v(" 查询 ")],1),n("el-button",{staticClass:"resetBtn",staticStyle:{"margin-left":"7px"},attrs:{type:"default",icon:"el-icon-refresh-right"},on:{click:t.searchrestBtn}},[t._v(" 重置 ")])],1),n("div",{staticClass:"el-tablenew"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,"row-class-name":t.tableRowClassName,border:"",height:"calc(100vh - 305px)"}},[n("el-table-column",{attrs:{fixed:"left",prop:"productCode",label:"生产指令",align:"center","min-width":"120px","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{fixed:"left",prop:"partsCode",label:"物料长代码",align:"center","min-width":"120px","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{fixed:"left",prop:"partsName",label:"产品名称",align:"center","min-width":"150px","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{fixed:"left",prop:"customerName",label:"客户名称",align:"center","min-width":"150px","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"partsCode",label:"发货时间",align:"center","min-width":"120px"}}),n("el-table-column",{attrs:{prop:"planCount",label:"计划数量",align:"center","min-width":"120px"}}),n("el-table-column",{attrs:{prop:"productCount",label:"实际生产数量",align:"center","min-width":"120px"}}),n("el-table-column",{attrs:{prop:"material",label:"原材料",align:"center","min-width":"120px"}}),n("el-table-column",{attrs:{prop:"startTime",label:"开始时间",align:"center","min-width":"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.startTime&&e.row.startTime.length>10?e.row.startTime.substring(0,16):e.row.startTime)+" ")]}}])}),n("el-table-column",{attrs:{prop:"endTime",label:"结束时间",align:"center","min-width":"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.endTime&&e.row.endTime.length>10?e.row.endTime.substring(0,16):e.row.endTime)+" ")]}}])}),n("el-table-column",{attrs:{prop:"priority",label:"优先级",align:"center","min-width":"90px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(0===e.row.priority?"普通":"优先")+" ")]}}])}),n("el-table-column",{attrs:{prop:"createTime",label:"状态",align:"center","min-width":"90px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(0===e.row.status?"未开始":1===e.row.status?"生产中":2===e.row.status?"暂停":"取消")+" ")]}}])}),n("el-table-column",{attrs:{prop:"note",label:"备注",align:"center","min-width":"150px"}}),n("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"330px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.hasPermission("doubleInstructionManage/stop")&&1===e.row.status?n("el-button",{staticClass:"deleteTextBtn",attrs:{type:"text",icon:"el-icon-caret-right"},on:{click:function(n){return t.stopBtn(e.row)}}},[t._v(" 暂停 ")]):t._e(),t.hasPermission("doubleInstructionManage/cancel")&&3!==e.row.status?n("el-button",{staticClass:"otherTextBtn",staticStyle:{color:"#969696"},attrs:{type:"text",icon:"el-icon-circle-close"},on:{click:function(n){return t.cancelBtn(e.row)}}},[t._v(" 取消 ")]):t._e(),t.hasPermission("doubleInstructionManage/moveUp")&&3!==e.row.status?n("el-button",{staticClass:"otherTextBtn",attrs:{type:"text",icon:"el-icon-top"},on:{click:function(n){return t.upBtn(e.row,e.$index)}}},[t._v(" 上移 ")]):t._e(),t.hasPermission("doubleInstructionManage/moveDown")&&3!==e.row.status?n("el-button",{staticClass:"defaultTextBtn",attrs:{type:"text",icon:"el-icon-bottom"},on:{click:function(n){return t.downBtn(e.row,e.$index)}}},[t._v(" 下移 ")]):t._e(),t.hasPermission("doubleInstructionManage/edit")&&3!==e.row.status?n("el-button",{staticClass:"addTextBtn",attrs:{type:"text"},on:{click:function(n){return t.editBtn(e.row)}}},[n("svg-icon",{attrs:{"icon-class":"edit"}}),t._v(" 编辑 ")],1):t._e()]}}])})],1),n("pagination",{staticClass:"pagePadd",attrs:{total:t.total,page:t.pageIndex,limit:t.pageSize},on:{"update:page":function(e){t.pageIndex=e},"update:limit":function(e){t.pageSize=e},pagination:t.handleCurrentChange}})],1),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"dialogs",attrs:{visible:t.dialogVisible,"close-on-click-modal":!1,title:"计划暂停",width:"665px"},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){return t.resetFrom("forms")}}},[n("el-form",{ref:"forms",attrs:{model:t.forms,rules:t.rules,"label-position":"left","label-width":"120px"}},[n("el-form-item",{attrs:{label:"计划暂停时长",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入计划暂停时长",size:"small",maxlength:"20"},on:{input:function(e){t.forms.min=t.forms.min.replace(/[^0-9]/g,"")}},model:{value:t.forms.min,callback:function(e){t.$set(t.forms,"min",e)},expression:"forms.min"}})],1),n("el-form-item",{attrs:{label:"计划暂停原因",prop:"reason"}},[n("el-input",{attrs:{rows:5,resize:"none",type:"textarea",placeholder:"请输入计划暂停原因",maxlength:"50"},model:{value:t.forms.reason,callback:function(e){t.$set(t.forms,"reason",e)},expression:"forms.reason"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticClass:"defaultBtn",staticStyle:{width:"120px","border-radius":"4px"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),n("el-button",{staticClass:"primaryBtn",staticStyle:{width:"120px"},attrs:{disabled:t.loading,type:"primary"},on:{click:function(e){return t.submitForm("forms")}}},[t._v("确定")])],1)],1),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"dialogs",attrs:{visible:t.dialogEditVisible,"close-on-click-modal":!1,title:"编辑",width:"665px"},on:{"update:visible":function(e){t.dialogEditVisible=e},close:function(e){return t.resetFrom("forms")}}},[n("el-form",{ref:"forms",attrs:{model:t.forms,rules:t.rules,"label-position":"left","label-width":"120px"}},[n("el-form-item",{attrs:{label:"生产数量",prop:"num"}},[n("el-input",{attrs:{placeholder:"请输入生产数量",size:"small",maxlength:"20"},on:{input:function(e){t.forms.num=t.forms.num.replace(/[^0-9]/g,"")}},model:{value:t.forms.num,callback:function(e){t.$set(t.forms,"num",e)},expression:"forms.num"}})],1),n("el-form-item",{attrs:{label:"预计耗时",prop:"deviceNum"}},[n("el-input",{attrs:{placeholder:"请输入预计耗时",size:"small",maxlength:"20"},on:{input:function(e){t.forms.num=t.forms.num.replace(/[^0-9]/g,"")}},model:{value:t.forms.deviceNum,callback:function(e){t.$set(t.forms,"deviceNum",e)},expression:"forms.deviceNum"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticClass:"defaultBtn",staticStyle:{width:"120px","border-radius":"4px"},on:{click:function(e){t.dialogEditVisible=!1}}},[t._v("取消")]),n("el-button",{staticClass:"primaryBtn",staticStyle:{width:"120px"},attrs:{disabled:t.loading,type:"primary"},on:{click:function(e){return t.submitForms("forms")}}},[t._v("确定")])],1)],1)],1)},o=[],a=(n("b0c0"),n("ac1f"),n("1276"),n("683d")),s=n("6ace"),r=n("ed08"),c=n("333d"),l=n("a888"),u={name:"DoubleInstructionManage",directives:{elDragDialog:l["a"]},components:{Pagination:c["a"]},data:function(){var t=this;return{activeNames:[],leftList:[],dialogVisible:!1,dialogEditVisible:!1,forms:{min:"",reason:"",num:"",deviceNum:""},rules:{min:[{required:!0,message:"请输入计划暂停时长",trigger:"blur"}],reason:[{required:!0,message:"请输入计划暂停原因",trigger:"blur"}],num:[{required:!0,message:"请输入生产数量",trigger:"blur"}],deviceNum:[{required:!0,message:"请选择生产设备编号",trigger:"blur"}]},searchKey:{key:"",code:"",codeIndex:"",status:"",name:"",startTime:"",endTime:""},statusList:[{id:0,name:"未开始"},{id:1,name:"生产中"},{id:2,name:"暂停"},{id:3,name:"取消"}],startPickerOptions:{disabledDate:function(e){return""!==t.searchKey.endTime&&null!==t.searchKey.endTime&&e.getTime()>t.searchKey.endTime}},endPickerOptions:{disabledDate:function(e){return""!==t.searchKey.startTime&&null!==t.searchKey.startTime&&e.getTime()<t.searchKey.startTime}},loading:!1,showDialog:!1,total:0,pageIndex:1,pageSize:10,currentId:0,beforeList:[],nextList:[],codeList:[],list:[]}},computed:{},mounted:function(){this.findDevicesLists(),this.fetchDate()},methods:{handleChange:function(t){},selectInfos:function(t){this.searchKey.codeIndex=t,this.fetchDate()},tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===1?"table-row":""},findDevicesLists:function(){var t=this;Object(s["a"])({}).then((function(e){t.codeList=e.data?e.data:[]}))},fetchDate:function(){var t=this;this.list=[],this.multipleSelection=[],this.loading=!0;var e=null;if(this.searchKey.codeIndex){var n=this.searchKey.codeIndex.split("-");e=this.leftList[parseInt(n[0])].children[parseInt(n[1])].id}var i=null;this.searchKey.startTime&&(i=Object(r["b"])(this.searchKey.startTime,"{y}-{m}-{d}")+" 00:00:00");var o=null;this.searchKey.endTime&&(o=Object(r["b"])(this.searchKey.endTime,"{y}-{m}-{d}")+" 23:59:59");var s={productDevicesId:e,productCode:this.searchKey.code+""?this.searchKey.code:null,status:this.searchKey.status+""?this.searchKey.status:null,partsCode:this.searchKey.name+""?this.searchKey.name:null,startTime:i,endTime:o,pageNum:this.pageIndex,pageSize:this.pageSize};Object(a["g"])(s).then((function(e){t.loading=!1,0===e.code&&(t.list=e.data.list,t.total=e.data.total)}))},searchBtn:function(){this.fetchDate()},searchrestBtn:function(){this.searchKey={key:"",code:"",codeIndex:"",status:"",name:"",startTime:"",endTime:""},this.pageIndex=1,this.pageSize=10,this.fetchDate()},handleSelectionChange:function(t){this.multipleSelection=t},handleCurrentChange:function(){this.fetchDate()},resetFrom:function(t){this.$refs[t].resetFields()},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(e.loading=!0,t){var n={stopReason:e.forms.reason,stopTime:e.forms.min,startTime:e.forms.startTime,injectionId:e.currentId};Object(a["n"])(n).then((function(t){e.loading=!1,0===t.code?(e.$message({message:"暂停成功!",type:"success"}),e.dialogVisible=!1,e.fetchDate()):1e3===t.code&&e.$message({message:t.msg,type:"error"})}))}}))},submitForms:function(t){var e=this;this.$refs[t].validate((function(t){if(t){e.loading=!0;var n={productTime:e.forms.deviceNum,planCount:e.forms.num,startTime:e.forms.startTime,id:e.currentId};Object(a["p"])(n).then((function(t){e.loading=!1,0===t.code?(e.$message({message:"编辑成功!",type:"success"}),e.dialogEditVisible=!1,e.fetchDate()):1e3===t.code&&e.$message({message:t.msg,type:"error"})}))}}))},stopBtn:function(t){this.currentId=t.id,this.dialogVisible=!0},cancelBtn:function(t){var e=this;this.$confirm("确定取消吗?","操作提示",{confirmButtonText:"确认",cancelButtonText:"取消"}).then((function(){var n={productDevicesId:t.productDevicesId,startTime:t.startTime,status:3,id:t.id};Object(a["a"])(n).then((function(t){e.loading=!1,0===t.code?(e.$message({message:"操作成功!",type:"success"}),e.fetchDate()):1e3===t.code&&e.$message({message:t.msg,type:"error"})}))}))},upBtn:function(t,e){var n=this;this.$confirm("确定上移吗?","操作提示",{confirmButtonText:"确认",cancelButtonText:"取消"}).then((function(){var e={productDevicesId:t.productDevicesId,startTime:t.startTime,moveCount:1,productTime:t.productTime,id:t.id};Object(a["l"])(e).then((function(t){n.loading=!1,0===t.code?(n.$message({message:"操作成功!",type:"success"}),n.fetchDate()):1e3===t.code&&n.$message({message:t.msg,type:"error"})}))}))},downBtn:function(t,e){var n=this;this.$confirm("确定下移吗?","操作提示",{confirmButtonText:"确认",cancelButtonText:"取消"}).then((function(){var e={productDevicesId:t.productDevicesId,startTime:t.startTime,moveCount:1,productTime:t.productTime,id:t.id};Object(a["j"])(e).then((function(t){n.loading=!1,0===t.code?(n.$message({message:"操作成功!",type:"success"}),n.dialogEditVisible=!1,n.fetchDate()):1e3===t.code&&n.$message({message:t.msg,type:"error"})}))}))},editBtn:function(t){this.currentId=t.id,this.forms.num=t.planCount,this.forms.deviceNum=t.productTime,this.forms.startTime=t.startTime,this.dialogEditVisible=!0}}},d=u,m=(n("7225"),n("2877")),p=Object(m["a"])(d,i,o,!1,null,"311fbb64",null);e["default"]=p.exports},"4c9c":function(t,e,n){},"683d":function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return a})),n.d(e,"h",(function(){return s})),n.d(e,"k",(function(){return r})),n.d(e,"m",(function(){return c})),n.d(e,"o",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"g",(function(){return m})),n.d(e,"l",(function(){return p})),n.d(e,"j",(function(){return f})),n.d(e,"n",(function(){return h})),n.d(e,"a",(function(){return g})),n.d(e,"i",(function(){return b})),n.d(e,"b",(function(){return w})),n.d(e,"p",(function(){return v}));var i=n("b775");function o(t){return Object(i["a"])({url:window.configs.api+"/injectionMolding/findList",method:"get",params:t})}function a(t){return Object(i["a"])({url:window.configs.api+"/injectionMolding/findPlanList",method:"post",data:t})}function s(t){return Object(i["a"])({url:window.configs.api+"/injectionMolding/insert",method:"post",data:t})}function r(t){return Object(i["a"])({url:window.configs.api+"/injectionMolding/moveUpDownCancel",method:"post",data:t})}function c(t){return Object(i["a"])({url:window.configs.api+"/injectionMolding/stop",method:"post",data:t})}function l(t){return Object(i["a"])({url:window.configs.api+"/injectionMolding/update",method:"post",data:t})}function u(){return Object(i["a"])({url:window.configs.e2cUrl+"/productDevices/findTreeList",method:"get"})}function d(t){return Object(i["a"])({url:window.configs.api+"/craftModel/findByProductCode",method:"get",params:t})}function m(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/findList",method:"get",params:t})}function p(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/moveUp",method:"post",data:t})}function f(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/moveDown",method:"post",data:t})}function h(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/stop",method:"post",data:t})}function g(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/cancel",method:"post",data:t})}function b(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/insert",method:"post",data:t})}function w(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/createProductCode",method:"get",params:t})}function v(t){return Object(i["a"])({url:window.configs.api+"/reworkInjection/update",method:"post",data:t})}},"6ace":function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var i=n("b775");function o(t){return Object(i["a"])({url:window.configs.api+"/attachment/upload",method:"post",data:t,heards:{"Content-Type":"multipart/form-data"}})}function a(t){return Object(i["a"])({url:window.configs.e2cUrl+"/productDevices/findList",method:"get",params:t})}function s(){return Object(i["a"])({url:window.configs.e2cUrl+"/devicesClassify/findList",method:"get"})}},7225:function(t,e,n){"use strict";var i=n("4c9c"),o=n.n(i);o.a},a888:function(t,e,n){"use strict";n("99af"),n("caad"),n("ac1f"),n("2532"),n("5319");var i={bind:function(t,e,n){var i=t.querySelector(".el-dialog__header"),o=t.querySelector(".el-dialog");i.style.cssText+=";cursor:move;",o.style.cssText+=";top:0px;";var a=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();i.onmousedown=function(t){var e=t.clientX-i.offsetLeft,s=t.clientY-i.offsetTop,r=o.offsetWidth,c=o.offsetHeight,l=document.body.clientWidth,u=document.body.clientHeight,d=o.offsetLeft,m=l-o.offsetLeft-r,p=o.offsetTop,f=u-o.offsetTop-c,h=a(o,"left"),g=a(o,"top");h.includes("%")?(h=+document.body.clientWidth*(+h.replace(/\%/g,"")/100),g=+document.body.clientHeight*(+g.replace(/\%/g,"")/100)):(h=+h.replace(/\px/g,""),g=+g.replace(/\px/g,"")),document.onmousemove=function(t){var i=t.clientX-e,a=t.clientY-s;-i>d?i=-d:i>m&&(i=m),-a>p?a=-p:a>f&&(a=f),o.style.cssText+=";left:".concat(i+h,"px;top:").concat(a+g,"px;"),n.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}},o=function(t){t.directive("el-drag-dialog",i)};window.Vue&&(window["el-drag-dialog"]=i,Vue.use(o)),i.install=o;e["a"]=i}}]);